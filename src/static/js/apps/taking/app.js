(function(){"use strict";var t={3990:function(t,e,s){var r=s(9242),a=s(3396);const n={class:"bg-dark"},l={class:"container bg-light"};function i(t,e,s,r,i,o){const c=(0,a.up)("loader"),d=(0,a.up)("nav-bar"),_=(0,a.up)("search-form"),u=(0,a.up)("product-description"),g=(0,a.up)("form-taking"),h=(0,a.up)("report-taking");return(0,a.wg)(),(0,a.iD)("div",n,[(0,a._)("div",l,[i.show_view.loader?((0,a.wg)(),(0,a.j4)(c,{key:0,server_status:i.server_status,onChangeView:e[0]||(e[0]=t=>o.switchView(t))},null,8,["server_status"])):(0,a.kq)("",!0),(0,a._)("div",null,[!1===i.show_view.loader?((0,a.wg)(),(0,a.j4)(d,{key:0,taking:i.taking,team:i.team,user:i.user,report:i.report,onChangeView:e[1]||(e[1]=t=>o.switchView(t))},null,8,["taking","team","user","report"])):(0,a.kq)("",!0),i.show_view.search_form?((0,a.wg)(),(0,a.j4)(_,{key:1,class:"mt-1",products:i.products,onSelectProduct:e[2]||(e[2]=t=>o.selectItem(t))},null,8,["products"])):(0,a.kq)("",!0),i.show_view.product_description?((0,a.wg)(),(0,a.j4)(u,{key:2,class:"mt-1",current_item:i.current_item,base_url:i.base_url,onChangeView:e[3]||(e[3]=t=>o.switchView(t))},null,8,["current_item","base_url"])):(0,a.kq)("",!0),i.show_view.taking_form?((0,a.wg)(),(0,a.j4)(g,{key:3,current_item:i.current_item,base_url:i.base_url,report:i.report,onChangeView:e[4]||(e[4]=t=>o.switchView(t))},null,8,["current_item","base_url","report"])):(0,a.kq)("",!0),i.show_view.report_info?((0,a.wg)(),(0,a.j4)(h,{key:4,report:i.report,team:i.team,user:i.user,taking:i.taking,base_url:i.base_url,server_status:i.server_status,onRemoveItem:e[5]||(e[5]=t=>o.deteleItemReport(t)),onSendReport:e[6]||(e[6]=t=>o.saveReport(t))},null,8,["report","team","user","taking","base_url","server_status"])):(0,a.kq)("",!0)])])])}s(6929);var o=s(7139);const c={class:"row"},d={class:"text-center"},_={key:0,class:"spinner-border",style:{width:"13rem",height:"13rem"},role:"status"},u=(0,a._)("span",{class:"visually-hidden"},"Cargando...",-1),g=[u],h=(0,a._)("div",{class:"row"},[(0,a._)("div",{class:"col text-center blink"},[(0,a._)("strong",{class:"h2 text-primary"},"CARGANDO APLICACIÓN...")])],-1),p={class:"row"},m={class:"col text-center"},b=["src"],w={class:"row text-center"},f=["textContent"],v=(0,a._)("div",{class:"row text-center"},[(0,a._)("a",{class:"btn btn-primary btn-block",href:"/mobile/dashboard/"},[(0,a._)("i",{class:"fas fa-home"}),(0,a.Uk)(" Recargar Aplicación ")])],-1);function k(t,e,s,r,n,l){return(0,a.wg)(),(0,a.iD)("div",null,[(0,a._)("div",c,[(0,a._)("div",d,[s.server_status.response?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",_,g))])]),h,(0,a._)("div",p,[(0,a._)("div",m,[(0,a._)("img",{style:{width:"80px"},src:"error"===s.server_status.issue_type?s.server_status.img_error:s.server_status.img_ok,alt:"status",class:"img-fluid"},null,8,b)])]),(0,a._)("div",w,[(0,a._)("strong",{class:(0,o.C_)(["h5","error"===s.server_status.issue_type?"text-danger":"text-success"]),textContent:(0,o.zw)(s.server_status.message)},null,10,f)]),v])}var x={name:"Loader",emits:["changeview"],props:{server_status:{type:Object,default:null,required:!0}},methods:{changeView(){this.$emit("changeView","search_form")}},beforeUnmount(){this.changeView()}},y=s(89);const C=(0,y.Z)(x,[["render",k]]);var z=C;const D={class:"navBar"},q={class:"card card-outline card-primary"},R={class:"card-header"},U={class:"row"},V={class:"col-8"},j=(0,a._)("i",{class:"fas fa-search text-primary"},null,-1),T=[j],O=(0,a._)("i",{class:"fas fa-table text-primary"},null,-1),A=(0,a._)("span",{class:"visually-hidden"},"unread messages",-1),I={class:"badge rounded-pill bg-danger"},P=(0,a._)("i",{class:"fas fa-users text-primary"},null,-1),S=[P],E={class:"col-4 text-end"},N=(0,a._)("i",{class:"fas fa-info-circle text-primary"},null,-1),L={key:0},B={class:"row bordered"},F={class:"col"},H={class:"row"},Z=(0,a._)("div",{class:"col-3 text-end border"},[(0,a._)("strong",{class:"text-secondary"},"Toma: ")],-1),$={class:"col border"},M={class:"row"},X=(0,a._)("div",{class:"col-3 text-end border"},[(0,a._)("strong",{class:"text-secondary"},"Grupo: ")],-1),G={class:"col border"},K={class:"row"},W=(0,a._)("div",{class:"col-3 text-end border"},[(0,a._)("strong",{class:"text-secondary"},"Nombre: ")],-1),J={class:"col border"},Y=["textContent"],Q={class:"row"},tt=(0,a._)("div",{class:"col-3 text-end border"},[(0,a._)("strong",{class:"text-secondary"},"Fecha: ")],-1),et={class:"col border"},st=["textContent"],rt={class:"row"},at=(0,a._)("div",{class:"col-3 text-end border"},[(0,a._)("strong",{class:"text-secondary"},"Asistente: ")],-1),nt={class:"col border"},lt={class:"row"},it=(0,a._)("div",{class:"col-3 text-end border"},[(0,a._)("strong",{class:"text-secondary"},"Auxiliar: ")],-1),ot={class:"col border"},ct={class:"row"},dt=(0,a._)("div",{class:"col-3 text-end border"},[(0,a._)("strong",{class:"text-secondary"},"Token: ")],-1),_t={class:"col text-break border"},ut=["textContent"],gt={class:"row"},ht=(0,a._)("i",{class:"fas fa-info-circle"},null,-1);function pt(t,e,s,r,n,l){return(0,a.wg)(),(0,a.iD)("div",D,[(0,a._)("div",q,[(0,a._)("div",R,[(0,a._)("div",U,[(0,a._)("div",V,[(0,a._)("button",{class:"btn btn",onClick:e[0]||(e[0]=t=>l.changeView("search_form"))},T),(0,a.Uk)("   "),(0,a._)("button",{class:"btn btn",onClick:e[1]||(e[1]=t=>l.changeView("report_info"))},[O,A,(0,a._)("small",I,(0,o.zw)(s.report.length),1)]),(0,a.Uk)("   "),(0,a._)("button",{class:"btn btn",onClick:e[2]||(e[2]=t=>l.changeView("group_form"))},S)]),(0,a._)("div",E,[(0,a._)("button",{class:"btn btn-sm bordered fw-bold",onClick:e[3]||(e[3]=(...t)=>l.showDetails&&l.showDetails(...t))},[N,(0,a.Uk)(" Toma: "+(0,o.zw)(s.taking.pk),1)])])])])]),n.show_details?((0,a.wg)(),(0,a.iD)("div",L,[(0,a._)("div",B,[(0,a._)("div",F,[(0,a._)("div",H,[Z,(0,a._)("div",$,(0,o.zw)(s.taking.pk),1)]),(0,a._)("div",M,[X,(0,a._)("div",G,(0,o.zw)(s.team.fields.group_number),1)]),(0,a._)("div",K,[W,(0,a._)("div",J,[(0,a._)("span",{class:"text-primary",textContent:(0,o.zw)(s.taking.fields.name)},null,8,Y)])]),(0,a._)("div",Q,[tt,(0,a._)("div",et,[(0,a._)("span",{textContent:(0,o.zw)(new Date(s.taking.fields.created).toLocaleString("es-EC"))},null,8,st)])]),(0,a._)("div",rt,[at,(0,a._)("div",nt,[(0,a._)("span",null,(0,o.zw)(s.user.fields.first_name)+" "+(0,o.zw)(s.user.fields.last_name),1)])]),(0,a._)("div",lt,[it,(0,a._)("div",ot,[(0,a._)("span",null,(0,o.zw)(s.user.fields.warenhouse_assistant),1)])]),(0,a._)("div",ct,[dt,(0,a._)("div",_t,[(0,a._)("span",{textContent:(0,o.zw)(s.team.fields.token_team)},null,8,ut)])])])]),(0,a._)("div",gt,[(0,a._)("button",{class:"btn btn-block btn-dark text-center",onClick:e[4]||(e[4]=(...t)=>l.showDetails&&l.showDetails(...t))},[ht,(0,a.Uk)(" Cerrar ")])])])):(0,a.kq)("",!0)])}var mt={name:"NavBar",props:{taking:{type:Object,default:null,required:!0},team:{type:Object,default:null,required:!0},user:{type:Object,default:null,required:!0},report:{type:Array,default:null,required:!0}},data(){return{show_details:!1}},emits:["changeView"],methods:{changeView(t){this.$emit("changeView",t)},showDetails(){this.show_details=!this.show_details}}};const bt=(0,y.Z)(mt,[["render",pt]]);var wt=bt;const ft={class:"card card-outline card-info"},vt={class:"card-header"},kt={id:"header"},xt={class:"row mt-1"},yt={class:"col"},Ct=(0,a._)("i",{class:"fas fa-search"},null,-1),zt=(0,a._)("span",{class:"text-info"}," Buscar",-1),Dt=[Ct,zt],qt={class:"col text-end"},Rt=(0,a._)("i",{class:"fas fa-barcode"},null,-1),Ut=(0,a._)("span",{class:"text-info"}," Escanear",-1),Vt=[Rt,Ut],jt={key:0,class:"row mt-1"},Tt={class:"col"},Ot={key:1,class:"row mt-1"},At={class:"col"},It={class:"row"},Pt={class:"col"},St=(0,a._)("small",null,"Resultados: ",-1),Et=["textContent"],Nt={key:0,class:"text-secondary"},Lt=["textContent"],Bt={class:"row"},Ft={class:"col"},Ht=["onClick"],Zt=["textContent"];function $t(t,e,s,n,l,i){const c=(0,a.up)("barcode-reader");return(0,a.wg)(),(0,a.iD)("div",ft,[(0,a._)("div",vt,[(0,a._)("div",kt,[(0,a._)("div",xt,[(0,a._)("div",yt,[(0,a._)("button",{type:"button",class:"btn bordered",onClick:e[0]||(e[0]=t=>l.show_barcode_reader=!1)},Dt)]),(0,a._)("div",qt,[(0,a._)("button",{class:"btn bordered",onClick:e[1]||(e[1]=t=>l.show_barcode_reader=!0)},Vt)])]),l.show_barcode_reader?((0,a.wg)(),(0,a.iD)("div",jt,[(0,a._)("div",Tt,[l.show_barcode_reader?((0,a.wg)(),(0,a.j4)(c,{key:0,onEan_code:e[2]||(e[2]=t=>i.selectByBarcode(t))})):(0,a.kq)("",!0)])])):(0,a.kq)("",!0),l.show_text_search?((0,a.wg)(),(0,a.iD)("div",Ot,[(0,a._)("div",At,[(0,a.wy)((0,a._)("input",{type:"text",class:"form-control","onUpdate:modelValue":e[3]||(e[3]=t=>l.query_search=t),onKeyup:e[4]||(e[4]=(...t)=>i.searchList&&i.searchList(...t))},null,544),[[r.nr,l.query_search]])])])):(0,a.kq)("",!0),(0,a._)("div",It,[(0,a._)("div",Pt,[St,(0,a._)("small",{class:"text-primary",textContent:(0,o.zw)(l.query_search)},null,8,Et),l.filtered_products?((0,a.wg)(),(0,a.iD)("small",Nt,[(0,a._)("small",{textContent:(0,o.zw)(l.filtered_products.length)},null,8,Lt),(0,a.Uk)(" registros encontrados de "+(0,o.zw)(s.products.length),1)])):(0,a.kq)("",!0)])]),(0,a._)("div",Bt,[(0,a._)("div",Ft,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(l.filtered_products,((t,e)=>((0,a.wg)(),(0,a.iD)("ul",{class:"list-group",key:e},[(0,a._)("li",{class:"list-group-item bg-gradient-light",onClick:e=>i.selectProduct(t)},[(0,a._)("small",{class:"text-secondary",textContent:(0,o.zw)(t.fields.name)},null,8,Zt)],8,Ht)])))),128))])])])])])}const Mt={class:"row"},Xt=(0,a._)("div",{class:"col mt-1"},[(0,a._)("video",{id:"video",class:"img-fluid"})],-1),Gt=[Xt];function Kt(t,e,s,r,n,l){return(0,a.wg)(),(0,a.iD)("div",Mt,Gt)}var Wt=s(928),Jt=s.n(Wt),Yt={name:"BarcodeReader",emits:["ean_code"],mounted(){const t=this,e=document.querySelector("#video");Jt().init({inputStream:{name:"Live",type:"LiveStream",target:e},decoder:{readers:["ean_reader"]}},(function(t){t?console.error("Error al inicializar Quagga:",t):(Jt().start(),navigator.mediaDevices.getUserMedia({video:!0}).then((function(t){e.srcObject=t,e.play()})).catch((function(t){alert("Error al acceder a la cámara: "+t)})))})),Jt().onDetected((function(e){console.log(e.codeResult.code),t.ean_code(e.codeResult.code),Jt().stop()})),Jt().onProcessed((function(t){const e=Jt().canvas.ctx.overlay,s=Jt().canvas.dom.overlay;t&&(t.boxes&&(e.clearRect(0,0,parseInt(s.getAttribute("width")),parseInt(s.getAttribute("height"))),t.boxes.filter((function(e){return e!==t.box})).forEach((function(t){Jt().ImageDebug.drawPath(t,{x:0,y:1},e,{color:"green",lineWidth:2})}))),t.box&&Jt().ImageDebug.drawPath(t.box,{x:0,y:1},e,{color:"#00F",lineWidth:2}),t.codeResult&&t.codeResult.code&&Jt().ImageDebug.drawPath(t.line,{x:"x",y:"y"},e,{color:"red",lineWidth:3}))}))},methods:{ean_code(t){Jt().stop(),this.$emit("ean_code",t)},stop(){Jt().stop()}},beforeUnmount(){Jt().stop()}};const Qt=(0,y.Z)(Yt,[["render",Kt]]);var te=Qt,ee={name:"SearchForm",props:["products"],emits:["selectProduct"],data(){return{query_search:"",filtered_products:[],show_text_search:!0,show_barcode_reader:!1}},methods:{searchList(){if(this.query_search.length<3)return!1;let t=this.query_search.toUpperCase().split(" ");this.filtered_products=this.products.filter((function(e){let s=!0;for(let r=0;r<t.length;r++)e.fields.name.search(t[r])<0&&(s=!1);return s})).slice(0,20)},selectProduct(t){this.$emit("selectProduct",t),this.show_barcode_reader=!1},selectByBarcode(t){this.query_search=t,this.show_barcode_reader=!1,this.show_text_search=!0,this.filtered_products=this.products.filter((function(e){return e.fields.ean_13_code===t}))}},components:{BarcodeReader:te}};const se=(0,y.Z)(ee,[["render",$t]]);var re=se;const ae={class:"card"},ne={class:"card-header"},le={class:"row"},ie={class:"col text-center"},oe={class:"text-secondary h6"},ce=(0,a._)("br",null,null,-1),de={class:"text-primary"},_e={class:"card-body"},ue={class:"row"},ge={class:"d-grid gap-2"},he=(0,a._)("i",{class:"fas fa-clipboard-check"},null,-1),pe=(0,a._)("br",null,null,-1),me={id:"detail"},be={class:"row"},we={class:"col text-center"},fe={class:"col"},ve=["src"],ke={key:0,class:"row h5"},xe={class:"col text-center"},ye={class:"col text-center"},Ce={class:"row"},ze={class:"col"},De={class:"table table-bordered table-compact"},qe=(0,a._)("th",{class:"bg-light bg-gradient text-end"},"Nombre:",-1),Re=["textContent"],Ue=(0,a._)("th",{class:"bg-light bg-gradient text-end"},"Cod Contable:",-1),Ve=["textContent"],je=(0,a._)("th",{class:"bg-light bg-gradient text-end"},"Capacidad:",-1),Te=["textContent"],Oe=["textContent"],Ae=(0,a._)("th",{class:"bg-light bg-gradient text-end"},"EAN 13:",-1),Ie=["textContent"],Pe=(0,a._)("th",{class:"bg-light bg-gradient text-end"},"EAN 14:",-1),Se=["textContent"],Ee=(0,a._)("th",{class:"bg-light bg-gradient text-end"},"Tipo:",-1),Ne=["textContent"],Le=(0,a._)("th",{class:"bg-light bg-gradient text-end"},"UND Venta:",-1),Be=["textContent"],Fe=(0,a._)("th",{class:"bg-light bg-gradient text-end"},"Grado Alc.:",-1),He=["textContent"],Ze=(0,a._)("th",{class:"bg-light bg-gradient text-end"},"Dim Caja:",-1),$e=["textContent"],Me=(0,a._)("th",{class:"bg-light bg-gradient text-end"},"Dim Product:",-1),Xe=["textContent"],Ge=(0,a._)("th",{class:"bg-light bg-gradient text-end"},"COD ICE:",-1),Ke=["textContent"],We=(0,a._)("th",{class:"bg-light bg-gradient text-end"},"Cantidad Caja:",-1),Je=["textContent"],Ye=(0,a._)("th",{class:"bg-light bg-gradient text-end"},"Registro Sanitario:",-1),Qe=["textContent"],ts={class:"row"},es={class:"d-grid gap-2"},ss=(0,a._)("i",{class:"fas fa-box"},null,-1);function rs(t,e,s,r,n,l){return(0,a.wg)(),(0,a.iD)("div",ae,[(0,a._)("div",ne,[(0,a._)("div",le,[(0,a._)("div",ie,[(0,a._)("strong",oe,(0,o.zw)(s.current_item.fields.name),1),ce,(0,a._)("span",de,(0,o.zw)(s.current_item.fields.ean_13_code),1)])]),(0,a._)("div",_e,[(0,a._)("div",ue,[(0,a._)("div",ge,[(0,a._)("button",{class:"btn btn-success btn-block",onClick:e[0]||(e[0]=t=>l.changeView("taking_form"))},[he,(0,a.Uk)(" Ingresar Toma ")]),pe])]),(0,a._)("div",me,[(0,a._)("div",be,[(0,a._)("div",we,[(0,a._)("div",fe,[(0,a._)("img",{src:n.default_picture,class:"img-fluid img-thumbnail"},null,8,ve)])])]),n.show_product?((0,a.wg)(),(0,a.iD)("div",ke,[(0,a._)("div",xe,[(0,a._)("span",{class:(0,o.C_)(["badge",n.class_bagded_front]),onClick:e[1]||(e[1]=t=>l.switchImage("front"))}," Fontal ",2)]),(0,a._)("div",ye,[(0,a._)("span",{class:(0,o.C_)(["badge",n.class_bagded_back]),onClick:e[2]||(e[2]=t=>l.switchImage("back"))}," Posterior ",2)])])):(0,a.kq)("",!0),(0,a._)("div",Ce,[(0,a._)("div",ze,[(0,a._)("table",De,[(0,a._)("tr",null,[qe,(0,a._)("td",{textContent:(0,o.zw)(s.current_item.fields.name)},null,8,Re)]),(0,a._)("tr",null,[Ue,(0,a._)("td",{textContent:(0,o.zw)(s.current_item.fields.account_code)},null,8,Ve)]),(0,a._)("tr",null,[je,(0,a._)("td",null,[(0,a._)("span",{textContent:(0,o.zw)(s.current_item.fields.capacity)},null,8,Te),(0,a.Uk)(),(0,a._)("span",{textContent:(0,o.zw)(s.current_item.fields.unit_measurement)},null,8,Oe)])]),(0,a._)("tr",null,[Ae,(0,a._)("td",{textContent:(0,o.zw)(s.current_item.fields.ean_13_code)},null,8,Ie)]),(0,a._)("tr",null,[Pe,(0,a._)("td",{textContent:(0,o.zw)(s.current_item.fields.ean_14_code)},null,8,Se)]),(0,a._)("tr",null,[Ee,(0,a._)("td",{textContent:(0,o.zw)(s.current_item.fields.type_product)},null,8,Ne)]),(0,a._)("tr",null,[Le,(0,a._)("td",{textContent:(0,o.zw)(s.current_item.fields.sale_unit_measurement)},null,8,Be)]),(0,a._)("tr",null,[Fe,(0,a._)("td",{textContent:(0,o.zw)(s.current_item.fields.alcoholic_strength)},null,8,He)]),(0,a._)("tr",null,[Ze,(0,a._)("td",{textContent:(0,o.zw)(s.current_item.fields.box_dimensions)},null,8,$e)]),(0,a._)("tr",null,[Me,(0,a._)("td",{textContent:(0,o.zw)(s.current_item.fields.product_dimensions)},null,8,Xe)]),(0,a._)("tr",null,[Ge,(0,a._)("td",{textContent:(0,o.zw)(s.current_item.fields.ice_code)},null,8,Ke)]),(0,a._)("tr",null,[We,(0,a._)("td",{textContent:(0,o.zw)(s.current_item.fields.quantity_per_box)},null,8,Je)]),(0,a._)("tr",null,[Ye,(0,a._)("td",{textContent:(0,o.zw)(s.current_item.fields.health_register)},null,8,Qe)])])])]),(0,a._)("div",ts,[(0,a._)("div",es,[(0,a._)("button",{class:"btn btn-primary btn-block",onClick:e[3]||(e[3]=t=>l.changeView("product_form"))},[ss,(0,a.Uk)(" Actualiza Ficha ")])])])])])])])}var as={name:"ProductDescription",props:{current_item:{type:Object,default:()=>{}},base_url:{type:String,default:""}},emit:["changeView"],data(){return{show_product:!1,default_picture:this.base_url+"/static/img/generic_product.png",class_bagded_front:"badge rounded-pill text-bg-primary",class_bagded_back:"badge rounded-pill text-bg-light"}},methods:{switchImage(t){"front"===t&&this.current_item.fields.image_front?(this.default_picture="/media/"+this.current_item.fields.image_front,this.class_bagded_front="badge-primary",this.class_bagded_back="badge-light"):"back"===t&&this.current_item.fields.image_back?(this.default_picture="/media/"+this.current_item.fields.image_back,this.class_bagded_back="badge-primary",this.class_bagded_front="badge-light"):this.default_picture="/static/img/generic_product.png"},changeView(t){this.$emit("changeView",t)}},mounted(){this.current_item.fields.image_front&&(this.default_picture="/media/"+this.current_item.fields.image_front)}};const ns=(0,y.Z)(as,[["render",rs]]);var ls=ns;const is={class:"card card-outline card-success mt-1"},os={class:"card-header"},cs={class:"row align-middle text-center"},ds={class:"col h6"},_s=(0,a._)("br",null,null,-1),us={class:"text-primary"},gs=(0,a._)("br",null,null,-1),hs={class:"text-primary"},ps={class:"text-primary"},ms={class:"card-body"},bs={class:"row mt-3"},ws={class:"col-4 text-center"},fs=["src"],vs={class:"col"},ks={class:"row"},xs=(0,a._)("div",{class:"col-5 text-end"},"Cajas:",-1),ys={class:"col"},Cs={class:"row mt-1"},zs=(0,a._)("div",{class:"col-5 text-end"},"Unds:",-1),Ds={class:"col"},qs={class:"row mt-1"},Rs=(0,a._)("div",{class:"col-5 text-end"},"Añada:",-1),Us={class:"col"},Vs={class:"row mt-1"},js=(0,a._)("div",{class:"col-5 text-end"},"Caducidad:",-1),Ts={class:"col"},Os={class:"row mt-1"},As=(0,a._)("div",{class:"col-3 text-end"},"Notas:",-1),Is={class:"col"},Ps={class:"card-footer mt-1 bg-ligth"},Ss={class:"row text-center"},Es={class:"col-6"},Ns=(0,a._)("i",{class:"fas fa-arrow-left"},null,-1),Ls={class:"col-6"},Bs=(0,a._)("i",{class:"fas fa-plus"},null,-1);function Fs(t,e,s,n,l,i){return(0,a.wg)(),(0,a.iD)("div",is,[(0,a._)("div",os,[(0,a._)("div",cs,[(0,a._)("div",ds,[(0,a.Uk)((0,o.zw)(s.current_item.fields.name)+" ",1),_s,(0,a._)("small",us," CAPACIDAD: "+(0,o.zw)(s.current_item.fields.capacity)+" "+(0,o.zw)(s.current_item.fields.unit_measurement),1),gs,(0,a._)("small",hs,[(0,a.Uk)("["+(0,o.zw)(s.current_item.fields.quantity_per_box)+" x Caja]  |  ",1),(0,a._)("span",ps,(0,o.zw)(s.current_item.fields.ean_13_code),1)])])])]),(0,a._)("div",ms,[(0,a._)("div",bs,[(0,a._)("div",ws,[(0,a._)("img",{src:s.current_item.fields.image_front?s.current_item.fields.image_front:l.default_picture,class:"img-fluid img-thumbnail"},null,8,fs)]),(0,a._)("div",vs,[(0,a._)("div",ks,[xs,(0,a._)("div",ys,[(0,a.wy)((0,a._)("input",{type:"number",class:"form-control taking-number text-end",autofocus:"","onUpdate:modelValue":e[0]||(e[0]=t=>l.current_taking.taking_total_boxes=t),onfocus:"this.value=''"},null,512),[[r.nr,l.current_taking.taking_total_boxes]])])]),(0,a._)("div",Cs,[zs,(0,a._)("div",Ds,[(0,a.wy)((0,a._)("input",{type:"number",class:"form-control taking-number text-end","onUpdate:modelValue":e[1]||(e[1]=t=>l.current_taking.taking_total_bottles=t),onfocus:"this.value=''"},null,512),[[r.nr,l.current_taking.taking_total_bottles]])])])])]),(0,a._)("div",qs,[Rs,(0,a._)("div",Us,[(0,a.wy)((0,a._)("input",{type:"number",class:"form-control taking-number text-end","onUpdate:modelValue":e[2]||(e[2]=t=>l.current_taking.year=t)},null,512),[[r.nr,l.current_taking.year]])])]),(0,a._)("div",Vs,[js,(0,a._)("div",Ts,[(0,a.wy)((0,a._)("input",{type:"date",class:"form-control taking-number text-end","onUpdate:modelValue":e[3]||(e[3]=t=>l.current_taking.date_expiry=t)},null,512),[[r.nr,l.current_taking.date_expiry]])])]),(0,a._)("div",Os,[As,(0,a._)("div",Is,[(0,a.wy)((0,a._)("textarea",{class:"form-control taking-text","onUpdate:modelValue":e[4]||(e[4]=t=>l.current_taking.notes=t)},null,512),[[r.nr,l.current_taking.notes]])])])]),(0,a._)("div",Ps,[(0,a._)("div",Ss,[(0,a._)("div",Es,[(0,a._)("button",{class:"btn btn-block btn-outline-secondary",onClick:e[5]||(e[5]=(...t)=>i.changeView&&i.changeView(...t))},[Ns,(0,a.Uk)(" Regresar")])]),(0,a._)("div",Ls,[(0,a._)("button",{class:"btn btn-block btn-success",onClick:e[6]||(e[6]=(...t)=>i.addReport&&i.addReport(...t))},[Bs,(0,a.Uk)(" Agregar")])])])])])}s(7658);var Hs={name:"FormTaking",props:{current_item:{type:Object,default:()=>{},required:!0},base_url:{type:String,default:()=>{},required:!0},report:{type:Array,default:()=>{},required:!0}},emits:["change-view"],data(){return{current_taking:{pk:null,product:null,taking_total_boxes:0,taking_total_bottles:0,date_expiry:null,year:null,notes:null},show_product:!0,default_picture:this.base_url+"/static/img/generic_product.png",class_bagded_front:"badge-primary",class_bagded_back:"badge-light"}},methods:{changeView(){this.$emit("changeView","search_form")},addReport(){"number"!=typeof this.current_taking.taking_total_boxes&&(this.current_taking.taking_total_boxes=0),"number"!=typeof this.current_taking.taking_total_bottles&&(this.current_taking.taking_total_bottles=0),this.current_taking.product=this.current_item,this.current_taking.pk=this.current_item.pk,this.report.push(this.current_taking),this.changeView()}},mounted(){this.current_item.fields.image_front&&(this.default_picture=this.base_url+"/media/"+this.current_item.fields.image_front)},updated(){this.current_taking.taking_total_boxes<=0&&(this.current_taking.taking_total_boxes=""),this.current_taking.taking_total_bottles<=0&&(this.current_taking.taking_total_bottles=""),this.current_taking.year<=0&&(this.current_taking.year="")}};const Zs=(0,y.Z)(Hs,[["render",Fs]]);var $s=Zs;const Ms={class:"card card-outline card-primary"},Xs={class:"card-header"},Gs={key:0},Ks={class:"row"},Ws={class:"col text-center"},Js=(0,a._)("i",{class:"fas fa-table"},null,-1),Ys={class:"h6"},Qs=(0,a._)("br",null,null,-1),tr={class:"text-info"},er=(0,a._)("br",null,null,-1),sr=["textContent"],rr=(0,a._)("br",null,null,-1),ar=(0,a._)("i",{class:"fas fa-file-excel"},null,-1),nr={class:"row mt-1"},lr={class:"col"},ir={class:"mi_table table table-striped",style:{width:"100%"}},or=(0,a._)("thead",null,[(0,a._)("tr",{class:"bg-secondary"},[(0,a._)("th",{class:"text-center"},"#"),(0,a._)("th",{class:"text-center"},"Producto"),(0,a._)("th",{class:"text-center"},"Cajas"),(0,a._)("th",{class:"text-center"},"Unds")])],-1),cr=["onClick"],dr={class:"text-center"},_r={class:""},ur={key:0,class:"fas fa-exclamation-triangle text-warning"},gr={class:"text-end"},hr={class:"text-end"},pr={class:"bg-secondary"},mr=(0,a._)("td",{class:"text-end",colspan:"2"},[(0,a._)("strong",null,"TOTALES")],-1),br={class:"text-end"},wr=["textContent"],fr={class:"text-end"},vr=["textContent"],kr={class:"row mt-3"},xr=["disabled"],yr=(0,a._)("i",{class:"fas fa-sync"},null,-1),Cr=["textContent"],zr={key:1,class:"text-center"},Dr=(0,a._)("strong",{class:"text-info H2"},"SIN DATOS",-1),qr=[Dr],Rr={key:2,class:"bg-white"},Ur={class:"card",style:{width:"100%"}},Vr={class:"row"},jr={class:"col text-center"},Tr=["src"],Or={class:"card-body"},Ar={class:"card-title text-center text-primary"},Ir={class:"card-text text-secondary"},Pr=["textContent"],Sr={key:1,class:"text-secondary"},Er={class:"list-group list-group-flush fs-5 text"},Nr={class:"list-group-item"},Lr={class:"row"},Br=(0,a._)("div",{class:"col-5 text-end"},[(0,a._)("span",{class:"text-secondary"},"Cajas:")],-1),Fr={class:"col text-end"},Hr={class:"list-group-item"},Zr={class:"row"},$r=(0,a._)("div",{class:"col-5 text-end"},[(0,a._)("span",{class:"text-secondary"},"Unidades:")],-1),Mr={class:"col text-end"},Xr={class:"list-group-item"},Gr={class:"row"},Kr=(0,a._)("div",{class:"col-5 text-end"},[(0,a._)("span",{class:"text-secondary"},"Añada:")],-1),Wr={class:"col text-end"},Jr={class:"list-group-item"},Yr={class:"row"},Qr=(0,a._)("div",{class:"col-5 text-end"},[(0,a._)("span",{class:"text-secondary"},"Caducidad:")],-1),ta={class:"col text-end"},ea={key:0},sa={class:"card-body"},ra={class:"row"},aa={class:"col text-center"},na=(0,a._)("i",{class:"fas fa-times"},null,-1),la={class:"col text-center"},ia=(0,a._)("i",{class:"fas fa-eraser"},null,-1);function oa(t,e,s,r,n,l){return(0,a.wg)(),(0,a.iD)("div",Ms,[(0,a._)("div",Xs,[s.report.length&&n.show_report?((0,a.wg)(),(0,a.iD)("div",Gs,[(0,a._)("div",Ks,[(0,a._)("div",Ws,[Js,(0,a._)("strong",Ys,[(0,a.Uk)((0,o.zw)(s.taking.fields.name)+" ",1),Qs,(0,a.Uk)(" Reporte Toma "),(0,a._)("small",tr,"["+(0,o.zw)(s.report.length)+"] items",1)]),er,(0,a._)("span",{textContent:(0,o.zw)(new Date(s.taking.fields.created).toLocaleString("es-EC"))},null,8,sr),rr,(0,a._)("button",{onClick:e[0]||(e[0]=(...t)=>l.downloadReport&&l.downloadReport(...t)),class:"btn btn-primary btn-sm"},[ar,(0,a.Uk)(" Descargar ")])])]),(0,a._)("div",nr,[(0,a._)("div",lr,[(0,a._)("table",ir,[or,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(s.report,((t,e)=>((0,a.wg)(),(0,a.iD)("tr",{key:t.pk,onClick:e=>l.showTaking(t)},[(0,a._)("td",dr,(0,o.zw)(e+1),1),(0,a._)("td",_r,[t.notes?((0,a.wg)(),(0,a.iD)("i",ur)):(0,a.kq)("",!0),(0,a.Uk)(" "+(0,o.zw)(t.product.fields.name),1)]),(0,a._)("td",gr,(0,o.zw)(t.taking_total_boxes),1),(0,a._)("td",hr,(0,o.zw)(t.taking_total_bottles),1)],8,cr)))),128)),(0,a._)("tr",pr,[mr,(0,a._)("td",br,[(0,a._)("strong",{textContent:(0,o.zw)(l.total_boxes)},null,8,wr)]),(0,a._)("td",fr,[(0,a._)("strong",{textContent:(0,o.zw)(l.total_bottles)},null,8,vr)])])])])])]),(0,a._)("div",kr,[(0,a._)("button",{class:(0,o.C_)(["btn btn-block",n.class_sync_btn]),onClick:e[1]||(e[1]=t=>l.sendReport()),disabled:t.disable_button_send},[yr,(0,a.Uk)(" "+(0,o.zw)(n.message_button)+" ",1),(0,a._)("small",null,[(0,a.Uk)(" ["),(0,a._)("span",{textContent:(0,o.zw)(s.report.length)},null,8,Cr),(0,a.Uk)(" items] ")])],10,xr)])])):(0,a.kq)("",!0),s.report.length?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",zr,qr)),n.show_taking?((0,a.wg)(),(0,a.iD)("div",Rr,[(0,a._)("div",Ur,[(0,a._)("div",Vr,[(0,a._)("div",jr,[(0,a._)("img",{src:n.selected_taking.product.fields.image_front?n.selected_taking.product.fields.image_front:n.default_picture,class:"card-img-top img-thumbnail",alt:"Imagen Producto",style:{width:"12em",height:"auto"}},null,8,Tr)])]),(0,a._)("div",Or,[(0,a._)("h5",Ar,(0,o.zw)(n.selected_taking.product.fields.name),1),(0,a._)("p",Ir,[n.selected_taking.notes?((0,a.wg)(),(0,a.iD)("span",{key:0,textContent:(0,o.zw)(n.selected_taking.notes)},null,8,Pr)):((0,a.wg)(),(0,a.iD)("span",Sr,"Sin Novedad"))])]),(0,a._)("ul",Er,[(0,a._)("li",Nr,[(0,a._)("div",Lr,[Br,(0,a._)("div",Fr,[(0,a._)("strong",null,(0,o.zw)(n.selected_taking.taking_total_boxes),1)])])]),(0,a._)("li",Hr,[(0,a._)("div",Zr,[$r,(0,a._)("div",Mr,[(0,a._)("strong",null,(0,o.zw)(n.selected_taking.taking_total_bottles),1)])])]),(0,a._)("li",Xr,[(0,a._)("div",Gr,[Kr,(0,a._)("div",Wr,[(0,a._)("strong",null,(0,o.zw)(n.selected_taking.year),1)])])]),(0,a._)("li",Jr,[(0,a._)("div",Yr,[Qr,(0,a._)("div",ta,[n.selected_taking.date_expiry?((0,a.wg)(),(0,a.iD)("strong",ea,(0,o.zw)(new Date(n.selected_taking.date_expiry).toLocaleString("es-EC").substring(0,10)),1)):(0,a.kq)("",!0)])])])]),(0,a._)("div",sa,[(0,a._)("div",ra,[(0,a._)("div",aa,[(0,a._)("button",{class:"btn btn-secondary",onClick:e[2]||(e[2]=(...t)=>l.showReport&&l.showReport(...t))},[na,(0,a.Uk)(" Cerrar ")])]),(0,a._)("div",la,[(0,a._)("button",{class:"btn btn-danger",onClick:e[3]||(e[3]=(...t)=>l.removeItem&&l.removeItem(...t))},[ia,(0,a.Uk)(" Eliminar ")])])])])])])):(0,a.kq)("",!0)])])}var ca=s(7092),da={emits:["sendReport"],name:"ReportTaking",props:{taking:{type:Object,default:null,required:!0},team:{type:Object,default:null,required:!0},user:{type:Object,default:null,required:!0},server_status:{type:Object,default:null,required:!0},report:{type:Array,default:null,required:!0},base_url:{type:String,default:null,required:!0}},data(){return{selected_taking:null,show_taking:!1,show_report:!0,confirm_report_send:!1,class_sync_btn:"btn-primary",message_button:"Sincronizar Datos",default_picture:this.base_url+"/static/img/generic_product.png"}},methods:{showTaking(t){this.selected_taking=t,this.show_report=!1,this.show_taking=!0},showReport(){this.show_report=!0,this.show_taking=!1},removeItem(){this.$emit("removeItem",this.selected_taking),this.showReport()},sendReport(){if(this.confirm_report_send)return this.disable_button_send=!0,this.downloadReport(),this.$emit("sendReport");this.confirm_report_send=!0,this.class_sync_btn="btn-success",this.message_button="Confirmar Reporte"},downloadReport(){let t=this.report.map((t=>({PK:t.pk,"ID Team":this.team.pk,token:this.team.fields.token_team,"Cuenta Contable":t.product.fields.account_code,Producto:t.product.fields.name,Cajas:t.taking_total_boxes,Unidades:t.taking_total_bottles,"Total UND":t.taking_total_boxes*t.product.fields.quantity_per_box+t.taking_total_bottles,"Añada":t.year,Caducidad:t.date_expiry,Novedad:t.notes})));const e=ca.P6.book_new(),s=ca.P6.json_to_sheet(t);ca.P6.book_append_sheet(e,s,"Reporte");let r=this.user.fields.username+"-"+this.taking.fields.name+"-"+this.taking.fields.created+"-.xlsx";(0,ca.NC)(e,r)}},computed:{total_boxes(){const t=0,e=this.report.reduce(((t,e)=>t+e.taking_total_boxes),t);return e},total_bottles(){this.report;const t=0,e=this.report.reduce(((t,e)=>t+e.taking_total_bottles),t);return e}}};const _a=(0,y.Z)(da,[["render",oa]]);var ua=_a;const ga=base_url,ha=url_data;var pa={name:"App",components:{Loader:z,NavBar:wt,SearchForm:re,ProductDescription:ls,FormTaking:$s,ReportTaking:ua},data(){return{team:null,products:null,user:null,taking:null,base_url:ga,url:ha,server_status:{response:null,issue_type:"",img_ok:ga+"/static/img/ok.jpg",img_error:ga+"/static/img/error.jpg",have_warning_message:!1,have_error_message:!1,message:""},current_item:null,report:[],csrf_token:null,have_team:!1,report_update:!1,show_status_message:!0,show_view:{loader:!0,search_form:!1,product_form:!1,group_form:!1,taking_form:!1,report_info:!1,product_description:!1,status_message:!1},disable_button_send:!1}},methods:{getData(){const t=new XMLHttpRequest;t.open("GET",this.base_url+this.url),t.setRequestHeader("Content-Type","application/json"),t.setRequestHeader("X-Requested-With","XMLHttpRequest"),t.onload=()=>{if(200===t.status){const e=JSON.parse(t.responseText);this.taking=e.taking,this.team=e.team,this.products=e.products,this.user=e.user,this.show_view.loader=!1,this.server_status.issue_type="success",this.server_status.message="Completado correctamente",this.server_status.response=e,this.csrf_token=csrf_token}},t.onerror=()=>{this.show_view.loader=!0,this.server_status.response=null,this.server_status.issue_type="error",this.server_status.message="Error al cargar los datos -> "+t.statusText},t.send()},saveReport(){this.show_view.loader=!0,this.server_status.response=null;const t=new XMLHttpRequest;t.open("POST",this.base_url+"/takings/add-report/"),t.setRequestHeader("Content-Type","application/json"),t.setRequestHeader("X-CSRFToken",this.csrf_token),t.onload=()=>{this.server_status.have_error_message=!0,this.show_view.report_info=!0,this.server_status.response=t.responseText,201===t.status?(this.server_status.message=t.responseText,console.dir(t)):400===t.status?(this.server_status.message=t.responseText,this.server_status.issue_type="warning"):(this.server_status.response=null,this.server_status.issue_type="error",this.server_status.message="Error al cargar los datos -> "+t.responseText)},t.onerror=()=>{this.server_status.response=null,this.server_status.have_error_message=!0,this.server_status.issue_type="error",this.server_status.message="Error al cargar los datos -> "+t.responseText},t.send(JSON.stringify({report:this.report,taking:this.taking,user:this.user,team:this.team}))},switchView(t){console.log(t);for(let e in this.show_view)this.show_view[e]=e===t},selectItem(t){this.current_item=t,this.switchView("product_description")},deteleItemReport(t){this.report=this.report.filter((e=>e!==t)),this.switchView("report_info")}},mounted(){this.getData()}};const ma=(0,y.Z)(pa,[["render",i]]);var ba=ma;(0,r.ri)(ba).mount("#app")}},e={};function s(r){var a=e[r];if(void 0!==a)return a.exports;var n=e[r]={exports:{}};return t[r].call(n.exports,n,n.exports,s),n.exports}s.m=t,function(){var t=[];s.O=function(e,r,a,n){if(!r){var l=1/0;for(d=0;d<t.length;d++){r=t[d][0],a=t[d][1],n=t[d][2];for(var i=!0,o=0;o<r.length;o++)(!1&n||l>=n)&&Object.keys(s.O).every((function(t){return s.O[t](r[o])}))?r.splice(o--,1):(i=!1,n<l&&(l=n));if(i){t.splice(d--,1);var c=a();void 0!==c&&(e=c)}}return e}n=n||0;for(var d=t.length;d>0&&t[d-1][2]>n;d--)t[d]=t[d-1];t[d]=[r,a,n]}}(),function(){s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,{a:e}),e}}(),function(){s.d=function(t,e){for(var r in e)s.o(e,r)&&!s.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={143:0};s.O.j=function(e){return 0===t[e]};var e=function(e,r){var a,n,l=r[0],i=r[1],o=r[2],c=0;if(l.some((function(e){return 0!==t[e]}))){for(a in i)s.o(i,a)&&(s.m[a]=i[a]);if(o)var d=o(s)}for(e&&e(r);c<l.length;c++)n=l[c],s.o(t,n)&&t[n]&&t[n][0](),t[n]=0;return s.O(d)},r=self["webpackChunktaking"]=self["webpackChunktaking"]||[];r.forEach(e.bind(null,0)),r.push=e.bind(null,r.push.bind(r))}();var r=s.O(void 0,[998],(function(){return s(3990)}));r=s.O(r)})();
//# sourceMappingURL=app.eb9c4b21.js.map
(function(){"use strict";var t={3616:function(t,e,a){var s=a(9242),n=a(3396);function l(t,e,a,s,l,r){const i=(0,n.up)("loader"),o=(0,n.up)("nav-bar"),c=(0,n.up)("info-bar"),d=(0,n.up)("taking-report");return(0,n.wg)(),(0,n.iD)("div",null,[l.serverStatus.haveData?(0,n.kq)("",!0):((0,n.wg)(),(0,n.j4)(i,{key:0,serverStatus:l.serverStatus},null,8,["serverStatus"])),l.serverStatus.haveData?((0,n.wg)(),(0,n.j4)(o,{key:1,reportTaking:l.reportTaking,allWarenhouses:l.allWarenhouses,allEnterprises:l.allEnterprises,confData:l.confData,taking:l.taking,userManager:l.userManager,allUsersAssistants:l.allUsersAssistants,teamsTaking:l.teamsTaking,syncs:t.syncs,onUpdateWarenhouses:e[0]||(e[0]=e=>t.updateWarenhouses(e))},null,8,["reportTaking","allWarenhouses","allEnterprises","confData","taking","userManager","allUsersAssistants","teamsTaking","syncs"])):(0,n.kq)("",!0),l.serverStatus.haveData?((0,n.wg)(),(0,n.j4)(c,{key:2,reportTaking:l.reportTaking,isShowAllTakings:l.isShowAllTakings,confData:l.confData,syncs:t.syncs,taking:l.taking,recounts:l.recounts,userManager:l.userManager,onShowAllTakings:e[1]||(e[1]=t=>r.showAllTakings(t)),onMakeRecount:e[2]||(e[2]=t=>r.makeRecount(t)),onCloseTaking:e[3]||(e[3]=t=>r.closeTaking(t))},null,8,["reportTaking","isShowAllTakings","confData","syncs","taking","recounts","userManager"])):(0,n.kq)("",!0),l.serverStatus.haveData&&l.filtered?((0,n.wg)(),(0,n.j4)(d,{key:3,tableTakings:l.tableTakings,reportTaking:l.reportTaking,confData:l.confData,isShowAllTakings:l.isShowAllTakings,IsTakingOpen:l.taking.is_active,serverStatus:l.serverStatus,taking:l.taking,onMakeRecount:e[4]||(e[4]=t=>r.makeRecount(t))},null,8,["tableTakings","reportTaking","confData","isShowAllTakings","IsTakingOpen","serverStatus","taking"])):(0,n.kq)("",!0)])}const r=base_url,i=id_taking,o={baseUrl:r,urlData:r+`/api/common/taking-data/${i}/`,urlUpdateTaking:r+`/api/takings/update-taking/${i}/`,urlUpdateTeam:r+`/api/common/add-team-taking/${i}/`,urlRecount:r+`/api/common/recount/${i}/{accountCode}/`,urlTakingProduct:r+`/api/common/taking-migration/taking/${i}/product/{accountCode}/`,urlDeleteTaking:r+"/api/takings-detail/delete/{idTakingDetail}/",urlReportDetailed:r+`/api/report-manager/taking/${i}/`,userData:user_data,headers:{Accept:"application/json","Content-Type":"application/json","X-CSRFToken":csrftoken}};var c=o,d=(a(8052),a(4161)),u=(a(6929),a(7139));const _=t=>((0,n.dD)("data-v-215767ca"),t=t(),(0,n.Cn)(),t),g={class:"container mt-5"},p={key:0,class:"row"},h=_((()=>(0,n._)("div",{class:"col text-center"},[(0,n._)("div",{class:"spinner-border text-primary",style:{width:"20rem",height:"20rem"},role:"status"})],-1))),k=[h],b={key:1,class:"row mt-5"},m=_((()=>(0,n._)("div",{class:"col text-center"},[(0,n._)("h1",{class:"text-secondary text-blink"}," Cargando Datos... ")],-1))),f=[m],w={key:2,class:"row mt-5 p-5"},v={class:"col text-center"},y={class:"text-danger"};function x(t,e,a,s,l,r){return(0,n.wg)(),(0,n.iD)("div",g,[a.serverStatus.fetching?((0,n.wg)(),(0,n.iD)("div",p,k)):(0,n.kq)("",!0),a.serverStatus.error?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("div",b,f)),a.serverStatus.error?((0,n.wg)(),(0,n.iD)("div",w,[(0,n._)("div",v,[(0,n._)("h1",y,(0,u.zw)(a.serverStatus.message),1)])])):(0,n.kq)("",!0)])}var D={name:"Loader",props:{serverStatus:{type:Object,required:!0}}},T=a(89);const C=(0,T.Z)(D,[["render",x],["__scopeId","data-v-215767ca"]]);var S=C;const R={class:"bg-light"},q={class:"navbar navbar-expand-lg navbar-light"},U={class:"container-fluid"},z={class:"navbar-brand text-primary",href:"#"},A=["textContent"],E=(0,n._)("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarText","aria-controls":"navbarText","aria-expanded":"false","aria-label":"Toggle navigation"},[(0,n._)("span",{class:"navbar-toggler-icon"})],-1),O={class:"collapse navbar-collapse",id:"navbarText"},j={class:"navbar-nav me-auto mb-2 mb-lg-0"},M=(0,n.uE)('<li class="nav-item"><a href="/" class="nav-link"><i class="fa-solid fa-home"></i> Inicio </a></li><li class="nav-item"><a href="/sap/" class="nav-link"><i class="fa-solid fa-server"></i> Saldos SAP </a></li><li class="nav-item"><a href="/takings/" class="nav-link"><i class="fa-solid fa-list-check"></i> Tomas </a></li><li>   </li>',4),H={class:"nav-link"},N={key:0,class:"badge rounded-pill bg-info text-dark"},L={key:1,class:"badge rounded-pill bg-info text-dark"},P={class:"nav-link"},W={key:0,class:"badge rounded-pill bg-info text-dark"},$={class:"nav-link"},X={key:0,class:"badge rounded-pill bg-info text-dark"},I={class:"navbar-nav ml-auto"},F={class:"nav-item"},B={class:"nav-link"},G=(0,n._)("span",null,[(0,n._)("small",null," Pendientes: ")],-1),K={class:"badge bg-danger text-dark"},Y={class:"nav-item"},Z={class:"nav-link"},J=(0,n._)("span",null,[(0,n._)("small",null," Completos: ")],-1),V={class:"badge bg-success"},Q={class:"nav-item"},tt={class:"nav-link"},et=(0,n._)("small",null," Progreso: ",-1),at={class:"text-light badge bg-primary"},st=(0,n._)("span",{class:"nav-div"},"    ",-1),nt={class:"navbar-nav ml-auto"},lt={class:"nav-item"},rt=(0,n._)("i",{class:"fas fa-user text-secondary"},null,-1),it={class:"navbar-text"},ot={class:"bnavbar-brand"},ct=(0,n._)("a",{href:"/accounts/logout/"},[(0,n._)("i",{class:"fas fa-power-off text-danger"})],-1),dt={class:"container-fluid"},ut={key:0,class:"row"},_t={class:"col-4"},gt={class:"card"},pt=(0,n._)("div",{class:"card-header"},[(0,n._)("h5",{class:"card-title text-info"},[(0,n._)("i",{class:"fas fa-house"}),(0,n.Uk)(" Empresas Seleccionadas ")])],-1),ht={class:"card-body"},kt={class:"list-group"},bt={class:"badge bg-secondary"},mt=(0,n._)("i",{class:"fas fa-xmark"},null,-1),ft={key:1,class:"row"},wt={class:"col-4"},vt={class:"card"},yt=(0,n._)("div",{class:"card-header"},[(0,n._)("h5",{class:"card-title text-success"},[(0,n._)("i",{class:"fa-solid fa-warehouse"}),(0,n.Uk)(" Bodegas Seleccionadas ")])],-1),xt={class:"card-body"},Dt={class:"list-group"},Tt=["onClick"],Ct={class:"badge bg-success bg-gradient"},St=(0,n._)("span",{class:"badge bg-light bg-gradient bordered text-danger"},[(0,n._)("i",{class:"fas fa-minus text-danger"}),(0,n.Uk)("   Eliminar ")],-1),Rt=(0,n._)("i",{class:"fas fa-xmark"},null,-1),qt={class:"card mt-3"},Ut=(0,n._)("div",{class:"card-header text-success"},[(0,n._)("h5",null,[(0,n._)("i",{class:"fas fa-list"}),(0,n.Uk)(" Categorías Seleccionadas ")])],-1),zt={class:"list-group list-group-flush"},At=(0,n._)("i",{class:"fas fa-check text-success"},null,-1),Et=(0,n._)("i",{class:"fas fa-box"},null,-1),Ot={class:"col-4"},jt={class:"card"},Mt={class:"card-header"},Ht={class:"card-title text-info"},Nt=(0,n._)("i",{class:"fa-solid fa-plus"},null,-1),Lt=(0,n._)("i",{class:"fa-solid fa-check"},null,-1),Pt={class:"card-body"},Wt={id:"table-whrs",class:"table table-bordered table-hover"},$t=(0,n._)("thead",null,[(0,n._)("tr",{class:"text-center"},[(0,n._)("th",null,"#"),(0,n._)("th",null,"Bodega"),(0,n._)("th",null,[(0,n._)("i",{class:"fas fa-gears"})])])],-1),Xt=["onClick"],It={class:"text-center"},Ft={class:"text-center"},Bt={key:0,class:"badge bg-light text-success"},Gt=(0,n._)("i",{class:"fas fa-plus text-success"},null,-1),Kt={key:2,class:"row"},Yt={class:"col-8"},Zt={class:"card"},Jt=(0,n._)("div",{class:"card-header"},[(0,n._)("h5",{class:"card-title text-info"},[(0,n._)("i",{class:"fa-solid fa-users"}),(0,n.Uk)(" Grupos Seleccionados ")])],-1),Vt={class:"card-body"},Qt={class:"table table-hover table-bordered"},te=(0,n._)("thead",null,[(0,n._)("tr",{class:"text-center"},[(0,n._)("th",null,"Grupo"),(0,n._)("th",null,"Manager"),(0,n._)("th",null,"Asistente"),(0,n._)("th",null,[(0,n._)("i",{class:"fas fa-refresh"})]),(0,n._)("th",null,"Ultima")])],-1),ee={class:"text-center"},ae={class:"badge bg-light text-secondary"},se={class:"text-center"},ne={class:"text-end"},le=(0,n._)("i",{class:"fas fa-xmark"},null,-1),re={class:"col-4"},ie={class:"card"},oe={class:"card-header"},ce={class:"card-title text-info"},de=(0,n._)("i",{class:"fa-solid fa-user-plus"},null,-1),ue=(0,n._)("i",{class:"fa-solid fa-check"},null,-1),_e={class:"card-body"},ge={class:"table table-hover table-bordered"},pe=(0,n._)("thead",null,[(0,n._)("tr",null,[(0,n._)("th",null,"#"),(0,n._)("th",null,"Asistente")])],-1),he=["onClick"],ke={class:"text-center"},be={key:0,class:"badge bg-success"};function me(t,e,a,l,r,i){return(0,n.wg)(),(0,n.iD)("div",R,[(0,n._)("nav",q,[(0,n._)("div",U,[(0,n._)("a",z,[(0,n.Uk)(" [T-"),a.taking?((0,n.wg)(),(0,n.iD)("span",{key:0,textContent:(0,u.zw)(a.taking.id_taking)},null,8,A)):(0,n.kq)("",!0),(0,n.Uk)("] "+(0,u.zw)(a.taking.name),1)]),E,(0,n._)("div",O,[(0,n._)("ul",j,[M,(0,n._)("li",{class:"nav-item",onClick:e[0]||(e[0]=t=>i.showDetail("enterprises"))},[(0,n._)("span",H,[(0,n.Uk)(" Empresas   "),a.allEnterprises?((0,n.wg)(),(0,n.iD)("span",N,(0,u.zw)(a.allEnterprises.length),1)):((0,n.wg)(),(0,n.iD)("span",L," Error "))])]),(0,n._)("li",{class:"nav-item",onClick:e[1]||(e[1]=t=>i.showDetail("warenhouses"))},[(0,n._)("span",P,[(0,n.Uk)("Bodegas   "),a.allWarenhouses.length?((0,n.wg)(),(0,n.iD)("span",W,(0,u.zw)(i.allWarenhousesSelected.length),1)):(0,n.kq)("",!0)])]),(0,n._)("li",{class:"nav-item",onClick:e[2]||(e[2]=t=>i.showDetail("groups"))},[(0,n._)("span",$,[(0,n.Uk)("Grupos   "),a.taking.teams.length?((0,n.wg)(),(0,n.iD)("span",X,(0,u.zw)(a.taking.teams.length),1)):(0,n.kq)("",!0)])])]),(0,n._)("ul",I,[(0,n._)("li",F,[(0,n._)("span",B,[G,(0,n._)("strong",K,(0,u.zw)(i.left_over),1)])]),(0,n.Uk)("   "),(0,n._)("li",Y,[(0,n._)("span",Z,[J,(0,n._)("strong",V,(0,u.zw)(i.full)+" / "+(0,u.zw)(a.reportTaking.length),1)])]),(0,n.Uk)("   "),(0,n._)("li",Q,[(0,n._)("span",tt,[et,(0,n._)("strong",at,(0,u.zw)(i.percent_progress)+"% ",1)])])]),st,(0,n._)("ul",nt,[(0,n._)("li",lt,[rt,(0,n.Uk)("   "),(0,n._)("span",it,[(0,n._)("small",ot,(0,u.zw)(a.confData["userData"].username),1),(0,n.Uk)("   "),ct])])])])])]),(0,n._)("div",dt,[r.showSection.enterprises?((0,n.wg)(),(0,n.iD)("div",ut,[(0,n._)("div",_t,[(0,n._)("div",gt,[pt,(0,n._)("div",ht,[(0,n._)("ul",kt,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(a.allEnterprises,((t,e)=>((0,n.wg)(),(0,n.iD)("li",{key:t,class:"list-group-item"},[(0,n._)("span",bt,(0,u.zw)(e+1),1),(0,n.Uk)(" "+(0,u.zw)(t),1)])))),128))]),(0,n._)("button",{class:"btn btn-sm btn-outline-dark mt-2",onClick:e[3]||(e[3]=(...t)=>i.showDetail&&i.showDetail(...t))},[mt,(0,n.Uk)(" Cerrar ")])])])])])):(0,n.kq)("",!0),r.showSection.warenhouses?((0,n.wg)(),(0,n.iD)("div",ft,[(0,n._)("div",wt,[(0,n._)("div",vt,[yt,(0,n._)("div",xt,[(0,n._)("ul",Dt,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(i.allWarenhousesSelected,((t,e)=>((0,n.wg)(),(0,n.iD)("li",{key:t,class:"list-group-item",onClick:e=>t.selected=!t.selected},[(0,n._)("span",Ct,(0,u.zw)(e+1),1),(0,n.Uk)("   "),St,(0,n.Uk)(" "+(0,u.zw)(t.name),1)],8,Tt)))),128))]),(0,n._)("button",{class:"btn btn-sm btn-outline-dark mt-2",onClick:e[4]||(e[4]=(...t)=>i.showDetail&&i.showDetail(...t))},[Rt,(0,n.Uk)(" Cerrar ")]),(0,n.Uk)("   ")])]),(0,n._)("div",qt,[Ut,(0,n._)("ul",zt,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(i.categories,(t=>((0,n.wg)(),(0,n.iD)("li",{class:"list-group-item",key:t},[At,(0,n.Uk)("   "),Et,(0,n.Uk)(" "+(0,u.zw)(t),1)])))),128))])])]),(0,n._)("div",Ot,[(0,n._)("div",jt,[(0,n._)("div",Mt,[(0,n._)("h5",Ht,[Nt,(0,n.Uk)("   Agregar Bodegas "),(0,n._)("button",{class:"btn btn-outline-success btn-sm float-end",onClick:e[5]||(e[5]=(...t)=>i.updateWarenhouses&&i.updateWarenhouses(...t))},[Lt,(0,n.Uk)(" Aplicar Cambios ")])])]),(0,n._)("div",Pt,[(0,n._)("table",Wt,[$t,(0,n._)("tbody",null,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(i.allWarenhousesUnseleted,((t,e)=>((0,n.wg)(),(0,n.iD)("tr",{key:t,onClick:e=>t.selected=!t.selected},[(0,n._)("td",It,(0,u.zw)(e+1),1),(0,n._)("td",null,(0,u.zw)(t.name),1),(0,n._)("td",Ft,[t.selected?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("span",Bt,[Gt,(0,n.Uk)(" Agregar ")]))])],8,Xt)))),128))])])])])])])):(0,n.kq)("",!0),r.showSection.groups?((0,n.wg)(),(0,n.iD)("div",Kt,[(0,n._)("div",Yt,[(0,n._)("div",Zt,[Jt,(0,n._)("div",Vt,[(0,n._)("table",Qt,[te,(0,n._)("tbody",null,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(a.teamsTaking,(t=>((0,n.wg)(),(0,n.iD)("tr",{key:t},[(0,n._)("td",ee,[(0,n.Uk)((0,u.zw)(t.group_number)+" ",1),(0,n._)("span",ae," # "+(0,u.zw)(t.id_team),1)]),(0,n._)("td",null,(0,u.zw)(t.manager.first_name)+" "+(0,u.zw)(t.manager.last_name),1),(0,n._)("td",null,(0,u.zw)(t.warenhouse_assistant),1),(0,n._)("td",se,(0,u.zw)(i.syncsTeams(t.id_team,"times")),1),(0,n._)("td",ne,[(0,n._)("span",null,(0,u.zw)(i.syncsTeams(t.id_team,"last")),1)])])))),128))])]),(0,n._)("button",{class:"btn btn-sm btn-outline-dark mt-2",onClick:e[6]||(e[6]=(...t)=>i.showDetail&&i.showDetail(...t))},[le,(0,n.Uk)(" Cerrar ")])])])]),(0,n._)("div",re,[(0,n._)("div",ie,[(0,n._)("div",oe,[(0,n._)("h5",ce,[de,(0,n.Uk)("   Agregar Grupos "),(0,n._)("button",{class:"btn btn-outline-success btn-sm float-end",onClick:e[7]||(e[7]=(...t)=>i.addTeams&&i.addTeams(...t))},[ue,(0,n.Uk)(" Aplicar Cambios ")])])]),(0,n._)("div",_e,[(0,n.wy)((0,n._)("input",{type:"text","onUpdate:modelValue":e[8]||(e[8]=t=>r.my_query=t),placeholder:"Buscar",onKeyup:e[9]||(e[9]=(...t)=>i.filterUsers&&i.filterUsers(...t)),class:"float-end form-control form-control-sm"},null,544),[[s.nr,r.my_query]]),(0,n._)("table",ge,[pe,(0,n._)("tbody",null,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(r.filteredUsers,((t,e)=>((0,n.wg)(),(0,n.iD)("tr",{key:t.id,onClick:e=>t.selected=!t.selected},[(0,n._)("td",ke,(0,u.zw)(e+1),1),(0,n._)("td",null,[t.selected?((0,n.wg)(),(0,n.iD)("span",be,"   Marcado Para Agregar ")):(0,n.kq)("",!0),(0,n.Uk)(" "+(0,u.zw)(t.first_name)+" "+(0,u.zw)(t.last_name),1)])],8,he)))),128))])])])])])])):(0,n.kq)("",!0)])])}var fe={name:"NavBar",emits:["updateGroups"],data(){return{showSection:{enterprises:!1,warenhouses:!1,groups:!1},my_query:null,filteredUsers:[]}},props:{reportTaking:{type:Object,required:!0},allWarenhouses:{type:Array,required:!0},confData:{type:Object,required:!0},taking:{type:Object,required:!0},userManager:{type:Object,required:!0},allUsersAssistants:{type:Array,required:!0},allEnterprises:{type:Array,required:!0},teamsTaking:{type:Array,required:!0},syncs:{type:Object,required:!0}},computed:{full(){return this.reportTaking.filter((t=>1==t.is_complete)).length},left_over(){return this.reportTaking.filter((t=>0==t.is_complete)).length},percent_progress(){return Math.round(this.full/this.reportTaking.length*100)},allWarenhousesSelected(){return this.allWarenhouses.filter((t=>1==t.selected))},allWarenhousesUnseleted(){return this.allWarenhouses.filter((t=>0==t.selected))},categories(){return JSON.parse(this.taking.categories)}},methods:{showDetail(t=null){1!=this.showSection[t]?(this.showSection.enterprises=!1,this.showSection.warenhouses=!1,this.showSection.groups=!1,null!==t&&(this.showSection[t]=!0)):this.showSection[t]=!1},filterUsers(){this.filteredUsers=this.allUsersAssistants.filter((t=>t.first_name.toLowerCase().includes(this.my_query.toLowerCase())||t.last_name.toLowerCase().includes(this.my_query.toLowerCase())))},updateWarenhouses(){const t=this.allWarenhousesSelected.map((t=>t.name)),e=JSON.parse(this.taking.warenhouses);if(JSON.stringify(t)===JSON.stringify(e))return void alert("No hay cambios");const a=this.confData.headers;this.taking.warenhouses=JSON.stringify(this.allWarenhousesSelected.filter((t=>1==t.selected)).map((t=>t.name))),d.Z.put(this.confData.urlUpdateTaking,this.taking,{headers:a}).then((t=>{200===t.status&&location.reload()})).catch((t=>{alert("Error al actualizar las bodegas"),consoledir(t)}))},addTeams(){const t={teams:this.allUsersAssistants.filter((t=>t.selected))};let e=new XMLHttpRequest;e.open("POST",this.confData.urlUpdateTeam),e.setRequestHeader("Content-Type","application/json"),e.setRequestHeader("X-Requested-With","XMLHttpRequest"),e.setRequestHeader("X-CSRFToken",this.confData.headers["X-CSRFToken"]),e.onload=()=>{200===e.status&&location.reload()},e.send(JSON.stringify(t)),e.onerror=()=>{alert("Error al agregar los grupos")}},syncsTeams(t,e){if("times"===e)return this.syncs["all"].filter((e=>e.id_team_id===t)).length;if("last"===e){const e=this.syncs["groups"].filter((e=>e.id_team_id===t));return e[0]?new Date(e[0].created).toLocaleString("es-EC"):"NO TIENE"}}},mounted(){this.filteredUsers=this.allUsersAssistants}};const we=(0,T.Z)(fe,[["render",me]]);var ve=we;const ye={class:"container-fluid mt-1 bg-light"},xe={class:"row"},De={class:"progress",style:{height:"0.2rem"}},Te=["aria-valuenow"],Ce={class:"row border bg-gardient-secondary rounded bg-gradient-light",style:{padding:"5px"}},Se={class:"col-10"},Re={class:"border rounded p-1 m-1"},qe=(0,n._)("i",{class:"fas fa-calendar"},null,-1),Ue={class:"border rounded p-1 m-1"},ze=(0,n._)("i",{class:"fas fa-location-dot"},null,-1),Ae={class:"border rounded p-1 m-1"},Ee=(0,n._)("i",{class:"fas fa-user"},null,-1),Oe={class:"badge bg-secondary"},je={class:"border rounded p-1 m-1"},Me=(0,n._)("i",{class:"fas fa-clock"},null,-1),He=(0,n._)("strong",null,"Inicio:",-1),Ne=(0,n._)("strong",null,"Fin:",-1),Le={key:0},Pe={key:1},We=(0,n._)("strong",null,"Duración:",-1),$e=(0,n._)("strong",null,"Conteos:",-1),Xe={class:"border rounded p-1 m-1"},Ie=(0,n._)("span",null,[(0,n._)("i",{class:"fas fa-info-circle"}),(0,n.Uk)("   "),(0,n._)("strong",null,"Estado:"),(0,n.Uk)("   ")],-1),Fe={key:0},Be=(0,n._)("i",{class:"fas fa-play text-success"},null,-1),Ge=(0,n._)("span",{class:"text-success"},"Abierto ",-1),Ke={key:1},Ye=(0,n._)("i",{class:"fas fa-stop text-danger"},null,-1),Ze=(0,n._)("span",{class:"text-danger"},"Cerrado",-1),Je={class:"m-1"},Ve=(0,n._)("i",{class:"fas fa-refresh"},null,-1),Qe={key:2,class:"m-1 text-success"},ta=(0,n._)("i",{class:"fas fa-eye"},null,-1),ea={key:3,class:"m-1 text-danger"},aa=(0,n._)("i",{class:"fas fa-exclamation-triangle"},null,-1),sa={class:"m-1"},na={key:0},la=(0,n._)("i",{class:"fas fa-check text-warning"},null,-1),ra={key:1},ia=(0,n._)("i",{class:"fas fa-share text-warning"},null,-1),oa={key:0},ca=(0,n._)("i",{class:"fas fa-stop text-danger"},null,-1),da={key:1},ua=(0,n._)("i",{class:"fas fa-check text-danger"},null,-1),_a={key:0},ga=(0,n._)("i",{class:"fa-solid fa-eye-slash text-warning"},null,-1),pa={key:1},ha=(0,n._)("i",{class:"fas fa-eye text-success"},null,-1),ka={class:"col text-end"},ba=(0,n._)("i",{class:"fas fa-file-excel text-success"},null,-1),ma={key:1,class:"btn-group",role:"group"},fa=(0,n._)("button",{id:"btnGroupDrop1",type:"button",class:"btn btn-outline-dark btn-sm ms-1 me-1 dropdown-toggle","data-bs-toggle":"dropdown","aria-expanded":"false"},[(0,n._)("i",{class:"fas fa-table text-success"}),(0,n.Uk)("   Reportes ")],-1),wa={class:"dropdown-menu","aria-labelledby":"btnGroupDrop1"},va=(0,n._)("span",{class:"dropdown-item"},[(0,n._)("i",{class:"fas fa-file-excel text-success"}),(0,n.Uk)(" Diferencias ")],-1),ya=[va],xa=["disabled"],Da=(0,n._)("span",{class:"dropdown-item"},[(0,n._)("i",{class:"fas fa-file-excel text-success"}),(0,n.Uk)(" Resumen Consolidado ")],-1),Ta=[Da],Ca=["disabled"],Sa=(0,n._)("span",{class:"dropdown-item"},[(0,n._)("i",{class:"fas fa-file-excel text-success"}),(0,n.Uk)(" Añadas")],-1),Ra=[Sa],qa=["disabled"],Ua=(0,n._)("span",{class:"dropdown-item"},[(0,n._)("i",{class:"fas fa-file-excel text-success"}),(0,n.Uk)(" Caducidades ")],-1),za=[Ua],Aa=["disabled"],Ea=(0,n._)("span",{class:"dropdown-item"},[(0,n._)("i",{class:"fas fa-file-excel text-success"}),(0,n.Uk)(" Novedades ")],-1),Oa=[Ea],ja=["disabled"],Ma=(0,n._)("span",{class:"dropdown-item"},[(0,n._)("i",{class:"fas fa-file-excel text-success"}),(0,n.Uk)(" Detallado ")],-1),Ha=[Ma];function Na(t,e,a,s,l,r){return(0,n.wg)(),(0,n.iD)("div",ye,[(0,n._)("div",xe,[(0,n._)("div",De,[(0,n._)("div",{class:"progress-bar bg-success",role:"progressbar",style:(0,u.j5)({width:r.percent_progress+"%"}),"aria-valuenow":r.percent_progress,"aria-valuemin":"0","aria-valuemax":"100"},null,12,Te),(0,n.Uk)(" AVANCE DE TOMA ")])]),(0,n._)("div",Ce,[(0,n._)("div",Se,[(0,n._)("span",Re,[qe,(0,n.Uk)(" "+(0,u.zw)(r.dateStart),1)]),(0,n._)("span",Ue,[ze,(0,n.Uk)(" "+(0,u.zw)(a.taking.location),1)]),(0,n._)("span",Ae,[Ee,(0,n.Uk)(" "+(0,u.zw)(a.userManager.first_name)+" "+(0,u.zw)(a.userManager.last_name)+" ",1),(0,n._)("small",Oe,(0,u.zw)(a.userManager.username),1)]),(0,n._)("span",je,[Me,(0,n.Uk)("   "),He,(0,n.Uk)(" "+(0,u.zw)(a.taking.hour_start.slice(0,5))+"   ",1),Ne,a.taking.hour_end?((0,n.wg)(),(0,n.iD)("span",Le,(0,u.zw)(a.taking.hour_end.slice(0,5)),1)):((0,n.wg)(),(0,n.iD)("span",Pe,"00:00")),(0,n.Uk)("   "),We,(0,n.Uk)(" "+(0,u.zw)(r.lapsed_time)+"   ",1),$e,(0,n.Uk)(" "+(0,u.zw)(a.recounts.length),1)]),(0,n._)("span",Xe,[Ie,a.taking.is_active?((0,n.wg)(),(0,n.iD)("span",Fe,[Be,(0,n.Uk)("  "),Ge])):((0,n.wg)(),(0,n.iD)("span",Ke,[Ye,(0,n.Uk)("  "),Ze])),(0,n._)("span",Je,[Ve,(0,n.Uk)(" "+(0,u.zw)(a.syncs.all.length),1)]),a.isShowAllTakings?((0,n.wg)(),(0,n.iD)("span",Qe,[ta,(0,n.Uk)(" TODO ")])):((0,n.wg)(),(0,n.iD)("span",ea,[aa,(0,n.Uk)(" DIFERENCIAS ")]))]),(0,n._)("span",sa,[a.taking.is_active?((0,n.wg)(),(0,n.iD)("button",{key:0,class:"btn btn-light btn-sm border",onClick:e[0]||(e[0]=(...t)=>r.makeRecount&&r.makeRecount(...t))},[l.recountConfirm?((0,n.wg)(),(0,n.iD)("strong",na,[la,(0,n.Uk)(" Confirmar ")])):((0,n.wg)(),(0,n.iD)("span",ra,[ia,(0,n.Uk)(" Reconteo ")]))])):(0,n.kq)("",!0),a.taking.is_active?((0,n.wg)(),(0,n.iD)("button",{key:1,class:"btn btn-light btn-sm ms-1 me-1 border",onClick:e[1]||(e[1]=(...t)=>r.closeTaking&&r.closeTaking(...t))},[l.closeConfirm?((0,n.wg)(),(0,n.iD)("strong",da,[ua,(0,n.Uk)(" Confirmar ")])):((0,n.wg)(),(0,n.iD)("span",oa,[ca,(0,n.Uk)(" Cerrar ")]))])):(0,n.kq)("",!0),(0,n._)("button",{class:"btn btn-light btn-sm border",onClick:e[2]||(e[2]=(...t)=>r.showAllTakings&&r.showAllTakings(...t))},[a.isShowAllTakings?((0,n.wg)(),(0,n.iD)("span",_a,[ga,(0,n.Uk)("   Listar Diferencias ")])):((0,n.wg)(),(0,n.iD)("span",pa,[ha,(0,n.Uk)(" Listar Todo ")]))])])]),(0,n._)("div",ka,[a.taking.is_active?((0,n.wg)(),(0,n.iD)("button",{key:0,class:"btn btn-outline-dark btn-sm border",onClick:e[3]||(e[3]=(...t)=>r.downloadReport&&r.downloadReport(...t))},[ba,(0,n.Uk)("   Reporte Reconteo ")])):(0,n.kq)("",!0),a.taking.is_active?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("div",ma,[fa,(0,n._)("ul",wa,[(0,n._)("li",{onClick:e[4]||(e[4]=t=>r.diffReport(!0,"Diferencias"))},ya),(0,n._)("li",{onClick:e[5]||(e[5]=t=>r.diffReport(!1,"Consolidado")),disabled:l.generatingReport},Ta,8,xa),(0,n._)("li",{onClick:e[6]||(e[6]=t=>r.extraReport("reportYears","Reporte Anadas")),disabled:l.generatingReport},Ra,8,Ca),(0,n._)("li",{onClick:e[7]||(e[7]=t=>r.extraReport("reportEndDate","Reporte Fechas")),disabled:l.generatingReport},za,8,qa),(0,n._)("li",{onClick:e[8]||(e[8]=t=>r.extraReport("reportNews","Reporte Novedades")),disabled:l.generatingReport},Oa,8,Aa),(0,n._)("li",{onClick:e[9]||(e[9]=t=>r.extraReport("reportAll","Rerporte Detallado")),disabled:l.generatingReport},Ha,8,ja)])]))])])])}var La=a(7092),Pa={name:"InfoBar",emits:["showAllTakings","makeRecount","closeTaking","changeAutoReload"],props:{reportTaking:{type:Array,required:!0},isShowAllTakings:{type:Boolean,required:!0},taking:{type:Object,required:!0},recounts:{type:Array,required:!0},syncs:{type:Object,required:!0},confData:{type:Object,required:!0},userManager:{type:Object,required:!0}},data(){return{recountConfirm:!1,closeConfirm:!1,generatingReport:!1,detailedReport:[]}},computed:{full(){return this.reportTaking.filter((t=>1==t.is_complete)).length},left_over(){return this.reportTaking.filter((t=>0==t.is_complete)).length},percent_progress(){return Math.round(this.full/this.reportTaking.length*100)},lapsed_time(){if(this.taking.is_active)return"En curso";if(!this.taking.hour_start||!this.taking.hour_end)return"00:00";const t=new Date(`2000-01-01T${this.taking.hour_start}`),e=new Date(`2000-01-01T${this.taking.hour_end}`),a=new Date(e-t),s=a.getUTCHours().toString().padStart(2,"0"),n=a.getUTCMinutes().toString().padStart(2,"0"),l=a.getUTCSeconds().toString().padStart(2,"0");return`${s}:${n}:${l}`},dateStart(){let t=this.taking.created.split("T")[0].split("-");return`${t[2]}/${t[1]}/${t[0]}`}},methods:{showAllTakings(){this.$emit("showAllTakings")},downloadReport(){let t=this.reportTaking.filter((t=>0==t.is_complete)).map((t=>({"Cod Contable":t.product.account_code,Producto:t.product.name,"Cod Barra":t.product.ean_13_code,"Cantidad Caja":t.product.quantity_per_box,Cajas:null,Botellas:null})));const e=La.P6.book_new(),a=La.P6.json_to_sheet(t),s=this.taking.name;a["!cols"]=[{wch:25},{wch:80},{wch:15},{wch:15},{wch:10},{wch:10}],a["!rows"]=[{hpx:30}],La.P6.book_append_sheet(e,a,"Reporte"),(0,La.NC)(e,"Reconteo [Toma #"+this.taking.id_taking+"]"+s+".xlsx")},diffReport(t,e){var a=t;let s=this.reportTaking.filter((t=>!a||0==t.is_complete)).map((t=>{let e="";return e=t.sap_stock>t.tk_quantity?"Faltante":t.sap_stock===t.tk_quantity?"Completo":"Sobrante",{"Cod Contable":t.product.account_code,Producto:t.product.name,"Cod Barra":t.product.ean_13_code,"Cantidad Caja":t.product.quantity_per_box,"Uns SAP":t.sap_stock,"Uns Conteo":t.tk_quantity,Diferencia:-1*(t.sap_stock-t.tk_quantity),"Estado ":e}}));const n=La.P6.book_new(),l=La.P6.json_to_sheet(s),r=this.taking.name;l["!cols"]=[{wch:25},{wch:80},{wch:15},{wch:15},{wch:10},{wch:10},{wch:10},{wch:10}],l["!rows"]=[{hpx:30}],La.P6.book_append_sheet(n,l,"Reporte"),(0,La.NC)(n,"Reporte "+e+" [Toma #"+this.taking.id_taking+"]"+r+".xlsx")},extraReport(t,e){if(this.generatingReport=!0,0===this.detailedReport.length){const a=this.confData.headers;d.Z.get(this.confData.urlReportDetailed,{headers:a}).then((a=>{this.detailedReport=a.data,this.extraReport(t,e)})).catch((t=>{console.log(t),alert("Error al intentar obtener el reporte")}))}var a=[];"reportYears"===t&&(a=this.detailedReport.filter((t=>null!==t.year))),"reportEndDate"===t&&(a=this.detailedReport.filter((t=>null!==t.date_expiry))),"reportNews"===t&&(a=this.detailedReport.filter((t=>null!==t.notes))),"reportAll"===t&&(a=this.detailedReport),a=a.map((t=>({"Cod Contable":t.account_code,Producto:t.name,"Unds X Caja":t.quantity_per_box,"Añada":t.year,"F Vencimiento":t.date_expiry,Observaciobes:t.notes,"T Unidades":t.quantity,Responsable:t.user})));const s=La.P6.book_new(),n=La.P6.json_to_sheet(a);n["!cols"]=[{wch:18},{wch:50},{wch:10},{wch:5},{wch:10},{wch:20},{wch:10},{wch:20}],n["!rows"]=[{hpx:30}],La.P6.book_append_sheet(s,n,"Reporte"),(0,La.NC)(s,`[Toma #${this.taking.id_taking}] ${e}.xlsx`),this.generatingReport=!1},makeRecount(){this.recountConfirm?this.$emit("makeRecount","all"):this.recountConfirm=!0},closeTaking(){this.closeConfirm?this.$emit("closeTaking",this.taking.id_taking):this.closeConfirm=!0},changeAutoReload(){this.$emit("changeAutoReload",this.auto_reload)}}};const Wa=(0,T.Z)(Pa,[["render",Na]]);var $a=Wa;const Xa={class:"bg-light"},Ia={key:0,class:"container-fluid mt-3"},Fa={class:"table table-hover table-bordered",id:"report"},Ba=(0,n._)("thead",null,[(0,n._)("tr",{class:"bg-secondary text-white"},[(0,n._)("th",{class:"text-center"},"#"),(0,n._)("th",{class:"text-center text-nowrap"},"Producto"),(0,n._)("th",{class:"text-center"},"SKU"),(0,n._)("th",{class:"text-center"},"Capacidad"),(0,n._)("th",{class:"text-center"},"CxCaja"),(0,n._)("th",{class:"text-center"},"Stock"),(0,n._)("th",{class:"text-center"},"Toma"),(0,n._)("th",{class:"text-center"},"Diff"),(0,n._)("th",{class:"text-center"},"Status")])],-1),Ga=["onClick"],Ka={class:"text-center"},Ya={class:"text-end"},Za={class:"text-end"},Ja={class:"text-end"},Va={class:"text-end"},Qa={class:"text-end"},ts={key:0,class:"text-center text-success"},es={key:1,class:"text-center text-danger"},as={key:2,class:"text-center"},ss={key:0,class:"text-info"},ns={key:1,class:"text-danger"},ls={key:1};function rs(t,e,a,s,l,r){const i=(0,n.up)("base-detail");return(0,n.wg)(),(0,n.iD)("div",Xa,[l.show_view_report?((0,n.wg)(),(0,n.iD)("div",Ia,[(0,n._)("table",Fa,[Ba,(0,n._)("tbody",null,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(a.tableTakings,((t,e)=>((0,n.wg)(),(0,n.iD)("tr",{key:t,onClick:e=>r.showItemDetail(t)},[(0,n._)("td",Ka,(0,u.zw)(e+1),1),(0,n._)("td",null,(0,u.zw)(t.product.name),1),(0,n._)("td",null,(0,u.zw)(t.product.ean_13_code),1),(0,n._)("td",Ya,(0,u.zw)(t.product.capacity),1),(0,n._)("td",Za,(0,u.zw)(t.product.quantity_per_box),1),(0,n._)("td",Ja,(0,u.zw)(t.sap_stock),1),(0,n._)("td",Va,(0,u.zw)(t.tk_quantity),1),(0,n._)("td",Qa,(0,u.zw)(t.tk_quantity-t.sap_stock),1),t.sap_stock===t.tk_quantity?((0,n.wg)(),(0,n.iD)("td",ts,"COMPLETO")):(0,n.kq)("",!0),t.sap_stock<t.tk_quantity?((0,n.wg)(),(0,n.iD)("td",es,"SOBRANTE")):(0,n.kq)("",!0),t.sap_stock>t.tk_quantity?((0,n.wg)(),(0,n.iD)("td",as,[0===t.tk_quantity?((0,n.wg)(),(0,n.iD)("span",ss,"SIN TOMA")):((0,n.wg)(),(0,n.iD)("span",ns,"FALTANTE"))])):(0,n.kq)("",!0)],8,Ga)))),128))])])])):((0,n.wg)(),(0,n.iD)("div",ls,[(0,n.Wm)(i,{selected_item:l.selected_item,show_view_report:l.show_view_report,confData:a.confData,reportTaking:a.reportTaking,taking:a.taking,serverStatus:a.serverStatus,onShowReport:r.showReport,onMakeRecount:e[0]||(e[0]=t=>r.makeRecount(t))},null,8,["selected_item","show_view_report","confData","reportTaking","taking","serverStatus","onShowReport"])]))])}var is=a(7387),os=a.n(is),cs=a(9498);const ds={key:1,class:"container-fluid mt-3 border bg-white"},us={class:"row bg bg-ligth bg-gradient h5"},_s={class:"col-1"},gs={class:"badge bg-dark"},ps={class:"col-10 text-center"},hs={class:"text-primary",id:"app-product-desc"},ks={class:"text-dark"},bs=(0,n._)("br",null,null,-1),ms=(0,n._)("hr",null,null,-1),fs={class:"col text-end"},ws=(0,n._)("i",{class:"fas fa-close"},null,-1),vs=[ws],ys={class:"row bg-ligth"},xs={class:"col-3"},Ds=["src"],Ts={class:"row"},Cs={class:"col"},Ss={class:"list-group"},Rs={class:"list-group-item"},qs=(0,n._)("strong",null,"Cod Contable:",-1),Us={class:"badge bg-dark"},zs={class:"list-group-item"},As=(0,n._)("strong",null,"Cap:",-1),Es=(0,n._)("span",{class:"text-seondary"}," |  ",-1),Os=(0,n._)("strong",null,"CxCaja:",-1),js={class:"col"},Ms={class:"d-flex align-items-start"},Hs={class:"nav flex-column nav-pills me-3",id:"v-pills-tab",role:"tablist","aria-orientation":"vertical"},Ns=(0,n.uE)('<button class="btn btn-white active btn-sm" data-bs-toggle="pill" data-bs-target="#v-pills-home"><i class="fas fa-clipboard-check"></i><br>Toma </button><button class="btn btn-white btn-sm" data-bs-toggle="pill" data-bs-target="#v-pills-profile"><i class="fas fa-warning"></i>  Novedades </button><button class="btn btn-white btn-sm" data-bs-toggle="pill" data-bs-target="#v-pills-messages"><i class="fas fa-warehouse"></i> Existencias </button>',3),Ls={key:0,class:"text-danger"},Ps=(0,n._)("i",{class:"fas fa-check"},null,-1),Ws={key:1},$s=(0,n._)("i",{class:"fas fa-share"},null,-1),Xs={class:"tab-content",id:"v-pills-tabContent",style:{width:"100%"}},Is={class:"tab-pane fade show active",id:"v-pills-home",role:"tabpanel","aria-labelledby":"v-pills-home-tab"},Fs={class:"border"},Bs={class:"row"},Gs={class:"col"},Ks={class:"row text-center"},Ys={class:"col text-center"},Zs=(0,n._)("span",{class:"h6"},"Stock",-1),Js={class:"h6"},Vs={class:"col text-center"},Qs=(0,n._)("span",{class:"text-primary h6"},"Toma",-1),tn={class:"text-primary h6"},en={class:"h6"},an={key:0,class:"h6"},sn={class:"row mt-2"},nn={class:"col"},ln={class:"table table-bordered table-hover"},rn=(0,n._)("thead",null,[(0,n._)("tr",{class:"text-center bg-gray-gradient"},[(0,n._)("th",null,"#"),(0,n._)("th",null,"Hora"),(0,n._)("th",null,"Grupo"),(0,n._)("th",null,"Manager"),(0,n._)("th",null,"Cajas"),(0,n._)("th",null,"Unds"),(0,n._)("th",null,"Total"),(0,n._)("th",{class:"text-center text-danger"},[(0,n._)("i",{class:"fas fa-trash"})])])],-1),on={class:"text-center"},cn={class:"text-center"},dn={class:"text-end"},un={class:"text-end"},_n={class:"text-end bg-gray"},gn=["onClick"],pn={key:0},hn={key:0,class:"fas fa-minus"},kn={key:1,class:"fa-solid fa-check text-danger"},bn={key:1},mn={class:"bg-success-gradient text-bold"},fn=(0,n._)("td",{colspan:"4",class:"text-end"},[(0,n._)("strong",null,"Sumas:")],-1),wn={class:"text-end"},vn={class:"text-end"},yn={class:"text-end"},xn=(0,n._)("td",{class:"text-center"},"--",-1),Dn={class:"tab-pane fade",id:"v-pills-profile",role:"tabpanel","aria-labelledby":"v-pills-profile-tab"},Tn={class:"row mt-2"},Cn={class:"col"},Sn={class:"table table-bordered table-hover"},Rn=(0,n._)("thead",null,[(0,n._)("tr",{class:"text-center bg-gray-gradient"},[(0,n._)("th",null,"#"),(0,n._)("th",null,"Grupo"),(0,n._)("th",null,"Novedad"),(0,n._)("th",null,"Año"),(0,n._)("th",null,"Caducidad"),(0,n._)("th",null,"Unds")])],-1),qn={class:"badge bg-info"},Un={class:"text-end"},zn={class:"text-end"},An={class:"text-end"},En={class:"tab-pane fade",id:"v-pills-messages",role:"tabpanel","aria-labelledby":"v-pills-messages-tab"},On={class:"row"},jn={class:"col"},Mn={class:"table table-bordered table-hover"},Hn=(0,n._)("thead",null,[(0,n._)("tr",{class:"text-center bg-gray-gradient"},[(0,n._)("th",null,"#"),(0,n._)("th",null,"Empresa"),(0,n._)("th",null,"Bodega"),(0,n._)("th",null,"Cajas"),(0,n._)("th",null,"Unds"),(0,n._)("th",null,"Total")])],-1),Nn={class:"badge bg-success"},Ln={class:"text-end"},Pn={class:"text-end"},Wn={class:"text-end"},$n={class:"bg-gray-gradient"},Xn=(0,n._)("th",{colspan:"3"},"Sumas",-1),In={class:"text-end"},Fn={class:"text-end"},Bn={class:"text-end"};function Gn(t,e,a,s,l,r){const i=(0,n.up)("loader");return(0,n.wg)(),(0,n.iD)("div",null,[l.item_report?(0,n.kq)("",!0):((0,n.wg)(),(0,n.j4)(i,{key:0,serverStatus:a.serverStatus},null,8,["serverStatus"])),l.item_report?((0,n.wg)(),(0,n.iD)("div",ds,[(0,n._)("div",us,[(0,n._)("div",_s,[(0,n._)("span",gs,(0,u.zw)(a.selected_item.product.type_product),1)]),(0,n._)("div",ps,[(0,n._)("span",hs,[(0,n.Uk)((0,u.zw)(a.selected_item.product.name)+"   ",1),(0,n._)("span",ks," Cajas X "+(0,u.zw)(a.selected_item.product.quantity_per_box)+" Unds ",1),bs,(0,n._)("small",null,(0,u.zw)(a.selected_item.product.ean_13_code),1)]),ms]),(0,n._)("div",fs,[(0,n._)("button",{class:"btn btn-outline-danger fs-5",onClick:e[0]||(e[0]=(...t)=>r.showReport&&r.showReport(...t))},vs)])]),(0,n._)("div",ys,[(0,n._)("div",xs,[(0,n._)("img",{src:r.image_url,class:"img-thumbnail"},null,8,Ds),(0,n._)("div",Ts,[(0,n._)("div",Cs,[(0,n._)("ul",Ss,[(0,n._)("li",{class:(0,u.C_)(["list-group-item text-center",r.status_taking.class])},[(0,n._)("i",{class:(0,u.C_)(r.status_taking.icon)},null,2),(0,n.Uk)("   "),(0,n._)("strong",null,(0,u.zw)(r.status_taking.text),1)],2),(0,n._)("li",Rs,[qs,(0,n.Uk)(" "+(0,u.zw)(a.selected_item.product.account_code)+"  |   ",1),(0,n._)("span",Us," #: "+(0,u.zw)(a.selected_item.product.id_product),1)]),(0,n._)("li",zs,[As,(0,n.Uk)(" "+(0,u.zw)(a.selected_item.product.capacity)+" ",1),Es,Os,(0,n.Uk)(" "+(0,u.zw)(a.selected_item.product.quantity_per_box),1)])])])])]),(0,n._)("div",js,[(0,n._)("div",Ms,[(0,n._)("div",Hs,[Ns,a.taking.is_active&&"Completo"!=r.status_taking.text?((0,n.wg)(),(0,n.iD)("button",{key:0,class:"btn btn-warning mt-5 btn-sm",id:"recount-item",onClick:e[1]||(e[1]=(...t)=>r.makeRecount&&r.makeRecount(...t))},[l.confirm_recount?((0,n.wg)(),(0,n.iD)("span",Ls,[Ps,(0,n.Uk)(" CONFIRMAR")])):((0,n.wg)(),(0,n.iD)("span",Ws,[$s,(0,n.Uk)(" RECONTEO ")]))])):(0,n.kq)("",!0)]),(0,n._)("div",Xs,[(0,n._)("div",Is,[(0,n._)("div",Fs,[(0,n._)("div",Bs,[(0,n._)("div",Gs,[(0,n._)("div",Ks,[(0,n._)("div",Ys,[Zs,(0,n.Uk)("   "),(0,n._)("span",Js,(0,u.zw)(a.selected_item.sap_stock),1)]),(0,n._)("div",Vs,[Qs,(0,n.Uk)("   "),(0,n._)("span",tn,(0,u.zw)(r.total_quantity),1)]),(0,n._)("div",{class:(0,u.C_)(["col text-center",r.status_taking.class])},[(0,n._)("i",{class:(0,u.C_)(["",r.status_taking.icon])},null,2),(0,n.Uk)("   "),(0,n._)("span",en,(0,u.zw)(r.status_taking.text),1),(0,n.Uk)("   "),r.sale_boxes?((0,n.wg)(),(0,n.iD)("span",an,(0,u.zw)(r.sale_boxes),1)):(0,n.kq)("",!0)],2)])])])]),(0,n._)("div",sn,[(0,n._)("div",nn,[(0,n._)("table",ln,[rn,(0,n._)("tbody",null,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(l.item_report.takings,((t,e)=>((0,n.wg)(),(0,n.iD)("tr",{key:t},[(0,n._)("td",on,(0,u.zw)(e+1),1),(0,n._)("td",null,(0,u.zw)(new Date(t.taking.created).toLocaleString("es-EC")),1),(0,n._)("td",cn,(0,u.zw)(t.team.group_number),1),(0,n._)("td",null,(0,u.zw)(t.user.first_name)+" "+(0,u.zw)(t.user.last_name),1),(0,n._)("td",dn,(0,u.zw)(t.taking.taking_total_boxes),1),(0,n._)("td",un,(0,u.zw)(t.taking.taking_total_bottles),1),(0,n._)("td",_n,(0,u.zw)(t.taking.quantity),1),(0,n._)("td",{class:"text-center text-danger",onClick:e=>r.delteItemDetail(t.taking.id_taking_detail)},[a.taking.is_active?((0,n.wg)(),(0,n.iD)("span",pn,[l.confirm_delete_detail?((0,n.wg)(),(0,n.iD)("i",kn)):((0,n.wg)(),(0,n.iD)("i",hn))])):((0,n.wg)(),(0,n.iD)("span",bn," -- "))],8,gn)])))),128)),(0,n._)("tr",mn,[fn,(0,n._)("td",wn,[(0,n._)("strong",null,(0,u.zw)(r.total_boxes),1)]),(0,n._)("td",vn,[(0,n._)("strong",null,(0,u.zw)(r.total_bottles),1)]),(0,n._)("td",yn,[(0,n._)("strong",null,(0,u.zw)(r.total_quantity),1)]),xn])])])])])]),(0,n._)("div",Dn,[(0,n._)("div",Tn,[(0,n._)("div",Cn,[(0,n._)("table",Sn,[Rn,(0,n._)("tbody",null,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(l.item_report.takings,((t,e)=>((0,n.wg)(),(0,n.iD)("tr",{key:t},[(0,n._)("td",null,(0,u.zw)(e+1),1),(0,n._)("td",null,[(0,n._)("span",qn,"G#"+(0,u.zw)(t.team.group_number),1),(0,n.Uk)(" "+(0,u.zw)(t.user.first_name)+" "+(0,u.zw)(t.user.last_name),1)]),(0,n._)("td",null,(0,u.zw)(t.taking.notes?t.taking.notes:"--"),1),(0,n._)("td",Un,(0,u.zw)(t.taking.year?t.taking.year:"--"),1),(0,n._)("td",zn,(0,u.zw)(t.taking.date_expiry?new Date(t.taking.date_expiry).toLocaleDateString("es-EC"):"--"),1),(0,n._)("td",An,(0,u.zw)(t.taking.quantity),1)])))),128))])])])])]),(0,n._)("div",En,[(0,n._)("div",On,[(0,n._)("div",jn,[(0,n._)("table",Mn,[Hn,(0,n._)("tbody",null,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(l.item_report.migrations,((t,e)=>((0,n.wg)(),(0,n.iD)("tr",{key:t},[(0,n._)("td",null,(0,u.zw)(e+1),1),(0,n._)("td",null,(0,u.zw)(t.company_name),1),(0,n._)("td",null,[(0,n._)("span",Nn,(0,u.zw)(t.id_warenhouse_sap_code),1),(0,n.Uk)(" "+(0,u.zw)(t.warenhouse_name),1)]),(0,n._)("td",Ln,(0,u.zw)(Math.floor(t.on_hand/a.selected_item.product.quantity_per_box)),1),(0,n._)("td",Pn,(0,u.zw)(t.on_hand-Math.floor(t.on_hand/a.selected_item.product.quantity_per_box)*a.selected_item.product.quantity_per_box),1),(0,n._)("td",Wn,(0,u.zw)(t.on_hand),1)])))),128)),(0,n._)("tr",$n,[Xn,(0,n._)("td",In,[(0,n._)("strong",null,(0,u.zw)(Math.floor(r.total_stocks/a.selected_item.product.quantity_per_box)),1)]),(0,n._)("td",Fn,[(0,n._)("strong",null,(0,u.zw)(r.total_stocks-Math.floor(r.total_stocks/a.selected_item.product.quantity_per_box)*a.selected_item.product.quantity_per_box),1)]),(0,n._)("td",Bn,[(0,n._)("strong",null,(0,u.zw)(r.total_stocks),1)])])])])])])])])])])])])):(0,n.kq)("",!0)])}var Kn={components:{Loader:S},name:"BaseDetail",componets:{Loader:S},emits:["showReport","makeRecount"],data(){return{item_report:null,stock_report:null,confirm_recount:!1,confirm_delete_detail:!1}},props:{selected_item:{type:Object,required:!0},show_view_report:{type:Boolean,required:!0},confData:{type:Object,required:!0},reportTaking:{type:Object,required:!0},taking:{type:Object,required:!0},serverStatus:{type:Object,required:!0}},methods:{showReport(){this.$emit("showReport")},sendGetRequest(t,e){const a=new XMLHttpRequest;a.open("GET",t),a.setRequestHeader("Content-Type","application/json"),a.setRequestHeader("X-Requested-With","XMLHttpRequest"),a.onload=()=>{if(200===a.status)return e(JSON.parse(a.responseText));alert("Error en peticion GET")},a.onerror=()=>{alert("Error en peticion GET evento on onerror")},a.send()},loadTakingData(t){this.item_report=t},makeRecount(){if(!this.confirm_recount)return this.confirm_recount=!0,!1;this.$emit("makeRecount",this.selected_item.product.account_code),this.showReport(),this.confirm_recount=!1},delteItemDetail(t){if(!this.taking.is_active)return;if(!this.confirm_delete_detail)return void(this.confirm_delete_detail=!0);let e=c.urlDeleteTaking.replace("{idTakingDetail}",t),a=new XMLHttpRequest;a.open("DELETE",e),a.setRequestHeader("Content-Type","application/json"),a.setRequestHeader("X-Requested-With","XMLHttpRequest"),a.setRequestHeader("X-CSRFToken",c.headers["X-CSRFToken"]),a.onload=()=>{204===a.status?(this.item_report.takings=this.item_report.takings.filter((e=>e.taking.id_taking_detail!==t)),location.reload()):alert("Error en peticion DELETE")},a.onerror=()=>{alert("Error en peticion DELETE evento on onerror")},a.send()}},mounted(){let t=this.confData.urlTakingProduct.replace("{accountCode}",this.selected_item.product.account_code);this.sendGetRequest(t,this.loadTakingData)},unmounted(){this.item_report=null},computed:{image_url(){return this.selected_item.product.image_front?this.confData.baseUrl+this.selected_item.product.image_front:this.confData.baseUrl+"/static/img/generic_product.png"},total_boxes(){return this.item_report.takings.reduce(((t,e)=>t+e.taking.taking_total_boxes),0)},total_bottles(){return this.item_report.takings.reduce(((t,e)=>t+e.taking.taking_total_bottles),0)},total_quantity(){return this.item_report.takings.reduce(((t,e)=>t+e.taking.quantity),0)},status_taking(){return this.selected_item.sap_stock===this.total_quantity?{text:"Completo",class:"text-success",icon:"fas fa-check"}:this.selected_item.sap_stock>this.total_quantity?{text:"Faltante",class:"text-warning",icon:"fas fa-exclamation-triangle"}:this.selected_item.sap_stock<this.total_quantity?{text:"Sobrante",class:"text-danger",icon:"fas fa-exclamation-triangle"}:void 0},sale_boxes(){return Math.abs(this.selected_item.sap_stock-this.total_quantity)},total_stocks(){return this.item_report.migrations.reduce(((t,e)=>t+e.on_hand),0)},boxesConverter(t){if("number"!=typeof t)return{boxes:0,bottles:0};let e=Math.floor(t/this.selected_item.product.quantity_per_box),a=t%this.selected_item.product.quantity_per_box;return{boxes:e,bottles:a}}}};const Yn=(0,T.Z)(Kn,[["render",Gn]]);var Zn=Yn;window.$=os(),window.jQuery=os();var Jn={name:"TakingReport",emits:["makeRecount"],props:{tableTakings:{type:Array,required:!0},confData:{type:Object,required:!0},isShowAllTakings:{type:Boolean,required:!0},IsTakingOpen:{type:Boolean,required:!0},reportTaking:{type:Array,required:!0},serverStatus:{type:Object,required:!0},taking:{type:Object,required:!0}},data(){return{selected_item:null,show_view_report:!0,datatable:null}},methods:{showItemDetail(t){this.show_view_report=!1,this.selected_item=t},showReport(){this.show_view_report=!0,this.$nextTick((()=>{this.initDataTable()}))},makeRecount(t){this.$emit("makeRecount",t)},initDataTable(){null!==this.datatable&&(this.datatable.destroy(),this.datatable=null),this.dataTable=new cs.Z("#report",{pageLength:25,lengthMenu:[10,25,50,75,100,200,500,1e3],language:{url:"//cdn.datatables.net/plug-ins/1.10.25/i18n/Spanish.json"}})}},components:{BaseDetail:Zn},watch:{show_view_report(){this.show_view_report&&this.initDataTable()}},mounted(){this.$nextTick((()=>{this.initDataTable()}))}};const Vn=(0,T.Z)(Jn,[["render",rs]]);var Qn=Vn;const tl=(0,n.uE)('<div class="container-fluid mt-3"><div class="row"><div class="col"><table class="table table-bordered table-hover" id="group-info"><thead><tr class="bg-primary text-white"><th class="text-center">#</th><th class="text-center"><i class="fas fa-user"></i></th><th class="text-center">Auxiliar</th><th class="text-center"><i class="fas fa-refresh"></i></th><th class="text-center"><i class="fas fa-clock"></i></th></tr></thead><tbody><tr><td class="text-center">1</td><td>Eduardo Villota</td><td>Afredo Caamanero</td><td class="text-center"><label for="" class="badge bg-success">21</label></td><td>12 de Febrero a las 09:00</td></tr><tr><td class="text-center">2</td><td>Carlos Villota</td><td>Carlos Caamanero</td><td class="text-center"><label for="" class="badge bg-success">21</label></td><td>12 de Febrero a las 09:00</td></tr><tr><td class="text-center">3</td><td>Carlos Villota</td><td>Carlos Caamanero</td><td class="text-center"><label for="" class="badge bg-success">21</label></td><td>12 de Febrero a las 09:00</td></tr></tbody></table></div><div class="col"><table class="table table-bordered table-hover"><thead><tr class="bg-secondary"><th>#</th><th>Producto</th><th>Toma</th></tr></thead><tbody><tr><td>1</td><td>Porducto en mejor de todos</td><td>423</td></tr></tbody></table></div></div></div>',1),el=[tl];function al(t,e,a,s,l,r){return(0,n.wg)(),(0,n.iD)("div",null,el)}var sl={name:"GroupsInfo",data:function(){return{data:"Genial"}},methods:{updateData:function(){this.data=[]}},mounted:function(){new cs.Z("#group-info",{pageLength:-1,lengthMenu:[[20,50,100,-1],["20","50","100","Todos"]],searching:!1,paging:!1})}};const nl=(0,T.Z)(sl,[["render",al]]);var ll=nl,rl={name:"App",components:{NavBar:ve,InfoBar:$a,TakingReport:Qn,GroupsInfo:ll,Loader:S},data(){return{confData:c,serverStatus:{fetching:!1,error:!1,message:null,haveData:!1},taking:null,allEnterprises:null,reportTaking:null,teamsTaking:null,userManager:null,allWarenhouses:null,allUsersAssistants:null,recounts:null,isShowAllTakings:!0,filtered:!0,takingIsOpen:!1,tableTakings:[]}},methods:{updateData:async function(){this.taking=null,this.allEnterprises=null,this.reportTaking=null,this.teamsTaking=null,this.userManager=null,this.allWarenhouses=null,this.allUsersAssistants=null,this.recounts=null,this.syncs=null,this.tableTakings=[],this.isShowAllTakings=!1,this.filtered=!0,this.takingIsOpen=!1,this.serverStatus.fetching=!0,this.serverStatus.haveData=!1;const t=this.confData.headers;d.Z.get(this.confData.urlData,{headers:t}).then((t=>{const e=t.data;this.taking=e.taking,this.allEnterprises=e.enterprises,this.reportTaking=e.report,this.teamsTaking=e.teams.sort(((t,e)=>t.group_number-e.group_number)),this.userManager=e.manager,this.allWarenhouses=e.all_warenhouses.sort(((t,e)=>t.name.localeCompare(e.name))),this.allUsersAssistants=e.all_users_assistants,this.recounts=e.recounts,this.syncs=e.syncs,this.serverStatus.fetching=!1,this.takingIsOpen=e.taking.is_active,this.isShowAllTakings=!1,this.serverStatus.haveData=!0,this.filterReport()})).catch((t=>{this.serverStatus.error=!0,this.serverStatus.fetching=!1,this.serverStatus.message="No es posible conectar con el servidor",console.dir(t)}))},showAllTakings(){this.isShowAllTakings=!this.isShowAllTakings,this.filterReport()},filterReport(){this.filtered=!1,setTimeout((()=>{this.filtered=!0,this.isShowAllTakings?this.tableTakings=this.reportTaking.map((t=>t)):this.tableTakings=this.reportTaking.filter((t=>!1===t.is_complete))}),50)},makeRecount(t){this.serverStatus.fetching=!0,this.serverStatus.haveData=!1;let e=this.confData.urlRecount.replace("{accountCode}",t);const a=new XMLHttpRequest;a.open("GET",e),a.setRequestHeader("Content-Type","application/json"),a.setRequestHeader("X-Requested-With","XMLHttpRequest"),a.setRequestHeader("X-CSRFToken",this.confData.headers["X-CSRFToken"]),a.onload=()=>{if(200===a.status){let e=JSON.parse(a.responseText);if("ok"!=e.status)return void alert(`Error al ejecutar accion ${e.status}`);if("all"===t)return void location.reload();this.serverStatus.fetching=!1,this.serverStatus.haveData=!0,this.reportTaking.forEach((e=>{e.product.account_code===t&&(e.tk_botles=0,e.tk_boxes=0,e.tk_quantity=0)}))}},a.onerror=t=>{this.serverStatus.fetching=!1,this.serverStatus.error=!0,this.serverStatus.message="Error al actualizar el estado de la toma",console.dir(t)},a.send()},closeTaking(t){this.serverStatus.fetching=!0,this.serverStatus.haveData=!1;let e=this.taking;e.is_active=!1,e.date_end_taking=(new Date).getTime();const a=new XMLHttpRequest;a.open("PUT",this.confData.urlUpdateTaking),a.setRequestHeader("Content-Type","application/json"),a.setRequestHeader("X-Requested-With","XMLHttpRequest"),a.setRequestHeader("X-CSRFToken",this.confData.headers["X-CSRFToken"]),a.onload=()=>{200===a.status&&location.reload()},a.onerror=t=>{this.serverStatus.fetching=!1,this.serverStatus.error=!0,this.serverStatus.message="Error al actualizar el estado de la toma",console.dir(t)},a.send(JSON.stringify(e))}},mounted(){this.updateData()},watch:{isShowAllTakings:function(){this.takingReport&&this.filterReport()}}};const il=(0,T.Z)(rl,[["render",l]]);var ol=il;(0,s.ri)(ol).mount("#app")}},e={};function a(s){var n=e[s];if(void 0!==n)return n.exports;var l=e[s]={exports:{}};return t[s].call(l.exports,l,l.exports,a),l.exports}a.m=t,function(){var t=[];a.O=function(e,s,n,l){if(!s){var r=1/0;for(d=0;d<t.length;d++){s=t[d][0],n=t[d][1],l=t[d][2];for(var i=!0,o=0;o<s.length;o++)(!1&l||r>=l)&&Object.keys(a.O).every((function(t){return a.O[t](s[o])}))?s.splice(o--,1):(i=!1,l<r&&(r=l));if(i){t.splice(d--,1);var c=n();void 0!==c&&(e=c)}}return e}l=l||0;for(var d=t.length;d>0&&t[d-1][2]>l;d--)t[d]=t[d-1];t[d]=[s,n,l]}}(),function(){a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,{a:e}),e}}(),function(){a.d=function(t,e){for(var s in e)a.o(e,s)&&!a.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){var t={143:0};a.O.j=function(e){return 0===t[e]};var e=function(e,s){var n,l,r=s[0],i=s[1],o=s[2],c=0;if(r.some((function(e){return 0!==t[e]}))){for(n in i)a.o(i,n)&&(a.m[n]=i[n]);if(o)var d=o(a)}for(e&&e(s);c<r.length;c++)l=r[c],a.o(t,l)&&t[l]&&t[l][0](),t[l]=0;return a.O(d)},s=self["webpackChunktaking_manager"]=self["webpackChunktaking_manager"]||[];s.forEach(e.bind(null,0)),s.push=e.bind(null,s.push.bind(s))}();var s=a.O(void 0,[998],(function(){return a(3616)}));s=a.O(s)})();
//# sourceMappingURL=app.fb9602e8.js.map
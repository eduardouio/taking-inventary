(function () { "use strict"; var t = { 2137: function (t, e, s) { var a = s(9242), n = s(3396); function r(t, e, s, a, r, l) { const o = (0, n.up)("loader"), i = (0, n.up)("nav-bar"), c = (0, n.up)("info-bar"), d = (0, n.up)("taking-report"); return (0, n.wg)(), (0, n.iD)("div", null, [r.report ? (0, n.kq)("", !0) : ((0, n.wg)(), (0, n.j4)(o, { key: 0 })), r.report ? ((0, n.wg)(), (0, n.j4)(i, { key: 1, report: r.report, warenhouses: r.warenhouses, userdata: r.userdata, base_url: r.base_url, onUpdateWarenhouses: e[0] || (e[0] = t => l.updateWarenhouses(t)) }, null, 8, ["report", "warenhouses", "userdata", "base_url"])) : (0, n.kq)("", !0), r.report ? ((0, n.wg)(), (0, n.j4)(c, { key: 2, report: r.report, show_all_takings: r.show_all_takings, "taking_is_open:": r.taking_is_open, csrf_token: r.csrf_token, onShowAllTakings: e[1] || (e[1] = t => l.showAllTakings(t)), onMakeRecount: e[2] || (e[2] = t => l.makeRecount(t)), onCloseTaking: e[3] || (e[3] = t => l.closeTaking(t)) }, null, 8, ["report", "show_all_takings", "taking_is_open:", "csrf_token"])) : (0, n.kq)("", !0), r.report && r.filtered ? ((0, n.wg)(), (0, n.j4)(d, { key: 3, report: r.report, table_takings: r.table_takings, base_url: r.base_url, show_all_takings: r.show_all_takings, taking_is_open: r.taking_is_open, csrf_token: r.csrf_token, onMakeRecount: e[4] || (e[4] = t => l.makeRecount(t)) }, null, 8, ["report", "table_takings", "base_url", "show_all_takings", "taking_is_open", "csrf_token"])) : (0, n.kq)("", !0)]) } s(8052), s(6929); const l = t => ((0, n.dD)("data-v-8d23aefa"), t = t(), (0, n.Cn)(), t), o = { class: "container mt-5" }, i = l((() => (0, n._)("div", { class: "row" }, [(0, n._)("div", { class: "col text-center" }, [(0, n._)("div", { class: "spinner-border text-primary", style: { width: "20rem", height: "20rem" }, role: "status" })])], -1))), c = l((() => (0, n._)("div", { class: "row mt-5" }, [(0, n._)("div", { class: "col text-center" }, [(0, n._)("h1", { class: "text-secondary text-blink" }, " Cargando Datos... ")])], -1))), d = [i, c]; function _(t, e, s, a, r, l) { return (0, n.wg)(), (0, n.iD)("div", o, d) } var u = { name: "Loader" }, p = s(89); const g = (0, p.Z)(u, [["render", _], ["__scopeId", "data-v-8d23aefa"]]); var h = g, k = s(7139); const b = { class: "bg-light" }, m = { class: "navbar navbar-expand-lg navbar-light" }, w = { class: "container-fluid" }, f = { class: "navbar-brand", href: "#" }, v = ["textContent"], y = (0, n._)("button", { class: "navbar-toggler", type: "button", "data-bs-toggle": "collapse", "data-bs-target": "#navbarText", "aria-controls": "navbarText", "aria-expanded": "false", "aria-label": "Toggle navigation" }, [(0, n._)("span", { class: "navbar-toggler-icon" })], -1), x = { class: "collapse navbar-collapse", id: "navbarText" }, q = { class: "navbar-nav me-auto mb-2 mb-lg-0" }, D = (0, n._)("li", { class: "nav-item" }, [(0, n._)("a", { href: "/", class: "nav-link" }, " Inicio ")], -1), C = { class: "nav-link" }, R = { key: 0, class: "badge rounded-pill bg-info text-dark" }, T = { key: 1, class: "badge rounded-pill bg-info text-dark" }, z = { class: "nav-link" }, U = { key: 0, class: "badge rounded-pill bg-info text-dark" }, E = { class: "nav-link" }, S = { key: 0, class: "badge rounded-pill bg-info text-dark" }, j = { class: "navbar-nav ml-auto" }, M = { class: "nav-item border" }, H = { class: "nav-link" }, O = (0, n._)("span", null, " Pendientes: ", -1), L = { class: "badge bg-danger text-dark" }, A = { class: "nav-item border" }, P = { class: "nav-link" }, X = (0, n._)("span", null, " Completos: ", -1), B = { class: "badge bg-success" }, N = { class: "nav-item border" }, G = { class: "nav-link" }, W = (0, n._)("span", null, " Progreso: ", -1), $ = { class: "text-light badge bg-primary" }, I = (0, n._)("span", { class: "nav-div" }, "    ", -1), F = { class: "navbar-nav ml-auto" }, K = { class: "nav-item" }, J = (0, n._)("i", { class: "fas fa-user text-secondary" }, null, -1), Y = { class: "navbar-text" }, Z = (0, n._)("a", { href: "/accounts/logout/" }, [(0, n._)("i", { class: "fas fa-power-off text-danger" })], -1), V = { class: "container-fluid" }, Q = { key: 0, class: "row" }, tt = { class: "col-4" }, et = { class: "card" }, st = (0, n._)("div", { class: "card-header" }, [(0, n._)("h5", { class: "card-title text-info" }, "Empresas")], -1), at = { class: "card-body" }, nt = (0, n._)("h6", { class: "card-subtitle mb-2 text-muted" }, "Listado de Propietarios", -1), rt = { class: "list-group" }, lt = { class: "badge bg-secondary" }, ot = (0, n._)("i", { class: "fas fa-xmark" }, null, -1), it = { key: 1, class: "row" }, ct = { class: "col-4" }, dt = { class: "card" }, _t = (0, n._)("div", { class: "card-header" }, [(0, n._)("h5", { class: "card-title text-info" }, [(0, n._)("i", { class: "fa-solid fa-warehouse" }), (0, n.Uk)(" Bodegas ")])], -1), ut = { class: "card-body" }, pt = (0, n._)("h6", { class: "card-subtitle mb-2 text-muted" }, "Listado de Bodegas", -1), gt = { class: "list-group" }, ht = ["onClick"], kt = (0, n._)("span", { class: "badge bg-secondary" }, [(0, n._)("i", { class: "fas fa-minus text-danger" }), (0, n.Uk)("   Eliminar ")], -1), bt = { key: 0, class: "badge bg-danger" }, mt = { key: 1 }, wt = { class: "badge bg-secondary" }, ft = (0, n._)("i", { class: "fas fa-xmark" }, null, -1), vt = { class: "col-4" }, yt = { class: "card" }, xt = { class: "card-header" }, qt = { class: "card-title text-info" }, Dt = (0, n._)("i", { class: "fa-solid fa-plus" }, null, -1), Ct = (0, n._)("i", { class: "fa-solid fa-check" }, null, -1), Rt = { class: "card-body" }, Tt = { id: "table-whrs", class: "table table-bordered table-hover" }, zt = (0, n._)("thead", null, [(0, n._)("tr", { class: "text-center" }, [(0, n._)("th", null, "#"), (0, n._)("th", null, "Bodega"), (0, n._)("th", null, [(0, n._)("i", { class: "fas fa-gears" })])])], -1), Ut = ["onClick"], Et = { class: "text-center" }, St = { class: "text-center" }, jt = { key: 0, class: "badge bg-secondary" }, Mt = (0, n._)("i", { class: "fas fa-plus text-success" }, null, -1), Ht = { key: 1, class: "badge bg-success" }, Ot = { key: 2, class: "row" }, Lt = { class: "col-8" }, At = { class: "card" }, Pt = (0, n._)("div", { class: "card-header" }, [(0, n._)("h5", { class: "card-title text-info" }, [(0, n._)("i", { class: "fa-solid fa-users" }), (0, n.Uk)(" Grupos ")])], -1), Xt = { class: "card-body" }, Bt = (0, n._)("h6", { class: "card-subtitle mb-2 text-muted" }, "Listado de Grupos", -1), Nt = { class: "table table-hover table-bordered" }, Gt = (0, n._)("thead", null, [(0, n._)("tr", { class: "text-center" }, [(0, n._)("th", null, "Grupo"), (0, n._)("th", null, "Manager"), (0, n._)("th", null, "Asistente"), (0, n._)("th", null, [(0, n._)("i", { class: "fas fa-refresh" })]), (0, n._)("th", null, "Ultima")])], -1), Wt = { class: "text-center" }, $t = { class: "text-center" }, It = { key: 0 }, Ft = { key: 1, class: "text-danger" }, Kt = (0, n._)("i", { class: "fas fa-xmark" }, null, -1), Jt = (0, n._)("button", { class: "btn btn-sm btn-outline-primary mt-2" }, [(0, n._)("i", { class: "fas fa-user-plus" }), (0, n.Uk)(" Agregar Grupo ")], -1), Yt = { class: "col-4" }, Zt = { class: "card" }, Vt = { class: "card-header" }, Qt = { class: "card-title text-info" }, te = (0, n._)("i", { class: "fa-solid fa-user-plus" }, null, -1), ee = (0, n._)("i", { class: "fa-solid fa-check" }, null, -1), se = { class: "card-body" }, ae = { class: "table table-hover table-bordered" }, ne = (0, n._)("thead", null, [(0, n._)("tr", null, [(0, n._)("th", null, "#"), (0, n._)("th", null, "Asistente")])], -1), re = ["onClick"], le = { class: "text-center" }, oe = { key: 0, class: "badge bg-success" }; function ie(t, e, s, r, l, o) { return (0, n.wg)(), (0, n.iD)("div", b, [(0, n._)("nav", m, [(0, n._)("div", w, [(0, n._)("a", f, [(0, n.Uk)("TOMA # "), s.report ? ((0, n.wg)(), (0, n.iD)("span", { key: 0, textContent: (0, k.zw)(s.report.taking.id_taking) }, null, 8, v)) : (0, n.kq)("", !0)]), y, (0, n._)("div", x, [(0, n._)("ul", q, [D, (0, n._)("li", { class: "nav-item", onClick: e[0] || (e[0] = t => o.showDetail("enterprises")) }, [(0, n._)("span", C, [(0, n.Uk)(" Empresas   "), s.report.enterprises.length ? ((0, n.wg)(), (0, n.iD)("span", R, (0, k.zw)(s.report.enterprises.length), 1)) : ((0, n.wg)(), (0, n.iD)("span", T, " Error "))])]), (0, n._)("li", { class: "nav-item", onClick: e[1] || (e[1] = t => o.showDetail("warenhouses")) }, [(0, n._)("span", z, [(0, n.Uk)("Bodegas   "), s.warenhouses.length ? ((0, n.wg)(), (0, n.iD)("span", U, (0, k.zw)(s.warenhouses.length), 1)) : (0, n.kq)("", !0)])]), (0, n._)("li", { class: "nav-item", onClick: e[2] || (e[2] = t => o.showDetail("groups")) }, [(0, n._)("span", E, [(0, n.Uk)("Grupos   "), s.report.teams.length ? ((0, n.wg)(), (0, n.iD)("span", S, (0, k.zw)(s.report.teams.length), 1)) : (0, n.kq)("", !0)])])]), (0, n._)("ul", j, [(0, n._)("li", M, [(0, n._)("span", H, [O, (0, n._)("strong", L, (0, k.zw)(o.left_over), 1)])]), (0, n.Uk)("   "), (0, n._)("li", A, [(0, n._)("span", P, [X, (0, n._)("strong", B, (0, k.zw)(o.full) + " / " + (0, k.zw)(s.report.report.length), 1)])]), (0, n.Uk)("   "), (0, n._)("li", N, [(0, n._)("span", G, [W, (0, n._)("strong", $, (0, k.zw)(o.percent_progress) + "% ", 1)])])]), I, (0, n._)("ul", F, [(0, n._)("li", K, [J, (0, n.Uk)("   "), (0, n._)("span", Y, [(0, n.Uk)((0, k.zw)(s.userdata.first_name) + " " + (0, k.zw)(s.userdata.last_name) + "   ", 1), Z])])])])])]), (0, n._)("div", V, [l.show_detail.enterprises ? ((0, n.wg)(), (0, n.iD)("div", Q, [(0, n._)("div", tt, [(0, n._)("div", et, [st, (0, n._)("div", at, [nt, (0, n._)("ul", rt, [((0, n.wg)(!0), (0, n.iD)(n.HY, null, (0, n.Ko)(s.report.enterprises, ((t, e) => ((0, n.wg)(), (0, n.iD)("li", { key: t, class: "list-group-item" }, [(0, n._)("span", lt, (0, k.zw)(e + 1), 1), (0, n.Uk)(" " + (0, k.zw)(t), 1)])))), 128))]), (0, n._)("button", { class: "btn btn-sm btn-outline-dark mt-2", onClick: e[3] || (e[3] = (...t) => o.showDetail && o.showDetail(...t)) }, [ot, (0, n.Uk)(" Cerrar ")])])])])])) : (0, n.kq)("", !0), l.show_detail.warenhouses ? ((0, n.wg)(), (0, n.iD)("div", it, [(0, n._)("div", ct, [(0, n._)("div", dt, [_t, (0, n._)("div", ut, [pt, (0, n._)("ul", gt, [((0, n.wg)(!0), (0, n.iD)(n.HY, null, (0, n.Ko)(s.warenhouses, ((t, e) => ((0, n.wg)(), (0, n.iD)("li", { key: t, class: "list-group-item", onClick: e => t.selected = !t.selected }, [kt, (0, n.Uk)("   "), t.selected ? (0, n.kq)("", !0) : ((0, n.wg)(), (0, n.iD)("span", bt, " Maracado Para Eliminar ")), t.selected ? (0, n.kq)("", !0) : ((0, n.wg)(), (0, n.iD)("span", mt, " ")), (0, n._)("span", wt, (0, k.zw)(e + 1), 1), (0, n.Uk)(" " + (0, k.zw)(t.name), 1)], 8, ht)))), 128))]), (0, n._)("button", { class: "btn btn-sm btn-outline-dark mt-2", onClick: e[4] || (e[4] = (...t) => o.showDetail && o.showDetail(...t)) }, [ft, (0, n.Uk)(" Cerrar ")]), (0, n.Uk)("   ")])])]), (0, n._)("div", vt, [(0, n._)("div", yt, [(0, n._)("div", xt, [(0, n._)("h5", qt, [Dt, (0, n.Uk)("   Agregar Bodegas "), (0, n._)("button", { class: "btn btn-outline-success btn-sm float-end", onClick: e[5] || (e[5] = (...t) => o.updateWarenhouses && o.updateWarenhouses(...t)) }, [Ct, (0, n.Uk)(" Aplicar Cambios ")])])]), (0, n._)("div", Rt, [(0, n._)("table", Tt, [zt, (0, n._)("tbody", null, [((0, n.wg)(!0), (0, n.iD)(n.HY, null, (0, n.Ko)(s.report.all_warenhouses, ((t, e) => ((0, n.wg)(), (0, n.iD)("tr", { key: t, onClick: e => t.selected = !t.selected }, [(0, n._)("td", Et, (0, k.zw)(e + 1), 1), (0, n._)("td", null, (0, k.zw)(t.name), 1), (0, n._)("td", St, [t.selected ? ((0, n.wg)(), (0, n.iD)("span", Ht, " Marcado Para Agregar ")) : ((0, n.wg)(), (0, n.iD)("span", jt, [Mt, (0, n.Uk)(" Agregar ")]))])], 8, Ut)))), 128))])])])])])])) : (0, n.kq)("", !0), l.show_detail.groups ? ((0, n.wg)(), (0, n.iD)("div", Ot, [(0, n._)("div", Lt, [(0, n._)("div", At, [Pt, (0, n._)("div", Xt, [Bt, (0, n._)("table", Nt, [Gt, (0, n._)("tbody", null, [((0, n.wg)(!0), (0, n.iD)(n.HY, null, (0, n.Ko)(s.report.teams, (t => ((0, n.wg)(), (0, n.iD)("tr", { key: t }, [(0, n._)("td", Wt, (0, k.zw)(t.group_number), 1), (0, n._)("td", null, (0, k.zw)(t.manager.first_name) + " " + (0, k.zw)(t.manager.last_name), 1), (0, n._)("td", null, (0, k.zw)(t.warenhouse_assistant), 1), (0, n._)("td", $t, (0, k.zw)(t.activity.count), 1), (0, n._)("td", null, [t.activity.last_taking ? ((0, n.wg)(), (0, n.iD)("span", It, (0, k.zw)(new Date(t.activity.last_taking).toLocaleString("es-Ec")), 1)) : ((0, n.wg)(), (0, n.iD)("span", Ft, "No tiene"))])])))), 128))])]), (0, n._)("button", { class: "btn btn-sm btn-outline-dark mt-2", onClick: e[6] || (e[6] = (...t) => o.showDetail && o.showDetail(...t)) }, [Kt, (0, n.Uk)(" Cerrar ")]), (0, n.Uk)("   "), Jt])])]), (0, n._)("div", Yt, [(0, n._)("div", Zt, [(0, n._)("div", Vt, [(0, n._)("h5", Qt, [te, (0, n.Uk)("   Agregar Grupos "), (0, n._)("button", { class: "btn btn-outline-success btn-sm float-end", onClick: e[7] || (e[7] = (...t) => o.addTeams && o.addTeams(...t)) }, [ee, (0, n.Uk)(" Aplicar Cambios ")])])]), (0, n._)("div", se, [(0, n.wy)((0, n._)("input", { type: "text", "onUpdate:modelValue": e[8] || (e[8] = t => l.my_query = t), placeholder: "Buscar", onKeyup: e[9] || (e[9] = (...t) => o.filterUsers && o.filterUsers(...t)), class: "float-end form-control form-control-sm" }, null, 544), [[a.nr, l.my_query]]), (0, n._)("table", ae, [ne, (0, n._)("tbody", null, [((0, n.wg)(!0), (0, n.iD)(n.HY, null, (0, n.Ko)(l.all_users_assistants, ((t, e) => ((0, n.wg)(), (0, n.iD)("tr", { key: t.id, onClick: e => t.selected = !t.selected }, [(0, n._)("td", le, (0, k.zw)(e + 1), 1), (0, n._)("td", null, [t.selected ? ((0, n.wg)(), (0, n.iD)("span", oe, "   Marcado Para Agregar ")) : (0, n.kq)("", !0), (0, n.Uk)(" " + (0, k.zw)(t.first_name) + " " + (0, k.zw)(t.last_name), 1)])], 8, re)))), 128))])])])])])])) : (0, n.kq)("", !0)])]) } var ce = { name: "NavBar", emits: ["updateWarenhouses", "updateGroups"], data() { return { show_detail: { enterprises: !1, warenhouses: !1, groups: !1 }, my_query: null, all_users_assistants: null } }, props: { report: { type: Object, required: !0 }, warenhouses: { type: Array, required: !0 }, userdata: { type: Object, required: !0 }, base_url: { type: String, required: !0 } }, computed: { full() { return this.report.report.filter((t => 1 == t.is_complete)).length }, left_over() { return this.report.report.filter((t => 0 == t.is_complete)).length }, percent_progress() { return Math.round(this.full / this.report.report.length * 100) } }, methods: { showDetail(t = null) { this.show_detail = { enterprises: !1, warenhouses: !1, groups: !1 }, null !== t && (this.show_detail[t] = !0) }, filterUsers() { this.all_users_assistants = this.report.all_users_assistants.map((t => t)), this.all_users_assistants = this.all_users_assistants.filter((t => t.first_name.toLowerCase().includes(this.my_query.toLowerCase()) || t.last_name.toLowerCase().includes(this.my_query.toLowerCase()))) }, updateWarenhouses() { this.$emit("updateWarenhouses") }, addTeams() { const t = { teams: this.all_users_assistants.filter((t => t.selected)) }; let e = new XMLHttpRequest; e.open("POST", this.base_url + "/api/common/add-team-taking/" + this.report.taking.id_taking + "/"), e.setRequestHeader("Content-Type", "application/json"), e.setRequestHeader("X-Requested-With", "XMLHttpRequest"), e.onload = () => { 200 === e.status && location.reload() }, e.send(JSON.stringify(t)), e.onerror = () => { alert("Error al agregar los grupos") } } }, mounted() { this.all_users_assistants = this.report.all_users_assistants.map((t => t)) } }; const de = (0, p.Z)(ce, [["render", ie]]); var _e = de; const ue = t => ((0, n.dD)("data-v-294e25fe"), t = t(), (0, n.Cn)(), t), pe = { class: "container-fluid mt-1 bg-light" }, ge = { class: "row" }, he = { class: "progress" }, ke = ["aria-valuenow"], be = { class: "row border bg-gardient-secondary rounded bg-gradient-light", style: { padding: "5px" } }, me = { class: "col-8" }, we = { key: 0 }, fe = ue((() => (0, n._)("i", { class: "fas fa-play text-success" }, null, -1))), ve = ue((() => (0, n._)("span", { class: "text-success" }, "Conteo Abierto, Recibiendo Datos ", -1))), ye = { key: 1 }, xe = ue((() => (0, n._)("i", { class: "fas fa-stop text-danger" }, null, -1))), qe = ue((() => (0, n._)("span", { class: "text-danger" }, "Conteo Cerrado ", -1))), De = ue((() => (0, n._)("input", { type: "checkbox" }, null, -1))), Ce = ue((() => (0, n._)("i", { class: "fa-solid fa-refresh" }, null, -1))), Re = { key: 0 }, Te = ue((() => (0, n._)("i", { class: "fas fa-check text-warning" }, null, -1))), ze = { key: 1 }, Ue = ue((() => (0, n._)("i", { class: "fas fa-share text-warning" }, null, -1))), Ee = { key: 0 }, Se = ue((() => (0, n._)("i", { class: "fas fa-stop text-danger" }, null, -1))), je = { key: 1 }, Me = ue((() => (0, n._)("i", { class: "fas fa-check text-danger" }, null, -1))), He = { key: 0 }, Oe = ue((() => (0, n._)("i", { class: "fa-solid fa-eye-slash text-warning" }, null, -1))), Le = { key: 1 }, Ae = ue((() => (0, n._)("i", { class: "fas fa-eye text-success" }, null, -1))), Pe = { key: 4, class: "badge bg-success" }, Xe = { key: 5, class: "badge bg-danger" }, Be = { class: "col text-end" }, Ne = { class: "text-info h6" }, Ge = ue((() => (0, n._)("i", { class: "fas fa-file-excel text-success" }, null, -1))), We = ue((() => (0, n._)("i", { class: "fas fa-file-excel text-success" }, null, -1))); function $e(t, e, s, a, r, l) { return (0, n.wg)(), (0, n.iD)("div", pe, [(0, n._)("div", ge, [(0, n._)("div", he, [(0, n._)("div", { class: "progress-bar bg-success", role: "progressbar", style: (0, k.j5)({ width: l.percent_progress + "%" }), "aria-valuenow": l.percent_progress, "aria-valuemin": "0", "aria-valuemax": "100" }, null, 12, ke), (0, n.Uk)(" AVANCE DE TOMA ")])]), (0, n._)("div", be, [(0, n._)("div", me, [(0, n.Uk)((0, k.zw)(new Date(s.report.taking.created).toLocaleString("es-Ec")) + "  |   Estado: ", 1), s.report.taking.is_active ? ((0, n.wg)(), (0, n.iD)("span", we, [fe, (0, n.Uk)("  "), ve])) : ((0, n.wg)(), (0, n.iD)("span", ye, [xe, (0, n.Uk)("  "), qe])), (0, n.Uk)("  |   "), De, (0, n.Uk)("   "), Ce, (0, n.Uk)(" Actualizar  |   "), s.report.taking.is_active ? ((0, n.wg)(), (0, n.iD)("button", { key: 2, class: "btn btn-secondary btn-sm", onClick: e[0] || (e[0] = (...t) => l.makeRecount && l.makeRecount(...t)) }, [r.recount_confirm ? ((0, n.wg)(), (0, n.iD)("strong", Re, [Te, (0, n.Uk)(" Confirmar ")])) : ((0, n.wg)(), (0, n.iD)("span", ze, [Ue, (0, n.Uk)(" Reconteo ")]))])) : (0, n.kq)("", !0), (0, n.Uk)("   "), s.report.taking.is_active ? ((0, n.wg)(), (0, n.iD)("button", { key: 3, class: "btn btn-secondary btn-sm", onClick: e[1] || (e[1] = (...t) => l.closeTaking && l.closeTaking(...t)) }, [r.close_confirm ? ((0, n.wg)(), (0, n.iD)("strong", je, [Me, (0, n.Uk)(" Confirmar ")])) : ((0, n.wg)(), (0, n.iD)("span", Ee, [Se, (0, n.Uk)(" Cerrar Toma ")]))])) : (0, n.kq)("", !0), (0, n.Uk)("   "), (0, n._)("button", { class: "btn btn-secondary btn-sm", onClick: e[2] || (e[2] = (...t) => l.showAllTakings && l.showAllTakings(...t)) }, [s.show_all_takings ? ((0, n.wg)(), (0, n.iD)("span", He, [Oe, (0, n.Uk)("   Mostrar Diferencias ")])) : ((0, n.wg)(), (0, n.iD)("span", Le, [Ae, (0, n.Uk)("  Mostrar Todo ")]))]), (0, n.Uk)("   "), s.show_all_takings ? ((0, n.wg)(), (0, n.iD)("span", Pe, " Se estan mostrando todos los registros ")) : ((0, n.wg)(), (0, n.iD)("span", Xe, " Solo se muestran los registros con diferencias "))]), (0, n._)("div", Be, [(0, n._)("strong", Ne, (0, k.zw)(s.report.taking.name), 1), (0, n.Uk)("   "), s.taking_is_open ? ((0, n.wg)(), (0, n.iD)("button", { key: 0, class: "btn btn-outline-secondary btn-sm", onClick: e[3] || (e[3] = (...t) => l.downloadReport && l.downloadReport(...t)) }, [Ge, (0, n.Uk)("   Reporte Reconteo ")])) : ((0, n.wg)(), (0, n.iD)("button", { key: 1, class: "btn btn-outline-secondary btn-sm", onClick: e[4] || (e[4] = (...t) => l.diffReport && l.diffReport(...t)) }, [We, (0, n.Uk)("   Reporte de Diferencias ")]))])])]) } var Ie = s(7092), Fe = { name: "InfoBar", emits: ["showAllTakings", "makeRecount", "closeTaking"], props: { report: { type: Object, required: !0 }, show_all_takings: { type: Boolean, required: !0 }, taking_is_open: { type: Boolean, required: !0 }, csrf_token: { type: String, required: !0 } }, data() { return { recount_confirm: !1, close_confirm: !1 } }, computed: { full() { return this.report.report.filter((t => 1 == t.is_complete)).length }, left_over() { return this.report.report.filter((t => 0 == t.is_complete)).length }, percent_progress() { return Math.round(this.full / this.report.report.length * 100) } }, methods: { showAllTakings() { this.$emit("showAllTakings") }, downloadReport() { let t = this.report.report.filter((t => 0 == t.is_complete)).map((t => ({ "Cod Contable": t.product.account_code, Producto: t.product.name, "Cod Barra": t.product.ean_13_code, "Cantidad Caja": t.product.quantity_per_box, Cajas: null, Botellas: null }))); const e = Ie.P6.book_new(), s = Ie.P6.json_to_sheet(t), a = this.report.taking.name; s["!cols"] = [{ wch: 25 }, { wch: 80 }, { wch: 15 }, { wch: 15 }, { wch: 10 }, { wch: 10 }], s["!rows"] = [{ hpx: 30 }], Ie.P6.book_append_sheet(e, s, "Reporte"), (0, Ie.NC)(e, "Reconteo [Toma #" + this.report.taking.id_taking + "]" + a + ".xlsx") }, diffReport() { let t = this.report.report.filter((t => 0 == t.is_complete)).map((t => { let e = ""; return e = t.sap_stock > t.tk_quantity ? "Faltante" : "Sobrante", { "Cod Contable": t.product.account_code, Producto: t.product.name, "Cod Barra": t.product.ean_13_code, "Cantidad Caja": t.product.quantity_per_box, "Uns SAP": t.sap_stock, "Uns Conteo": t.tk_quantity, Diferencia: -1 * (t.sap_stock - t.tk_quantity), "Estado ": e } })); const e = Ie.P6.book_new(), s = Ie.P6.json_to_sheet(t), a = this.report.taking.name; s["!cols"] = [{ wch: 25 }, { wch: 80 }, { wch: 15 }, { wch: 15 }, { wch: 10 }, { wch: 10 }, { wch: 10 }, { wch: 10 }], s["!rows"] = [{ hpx: 30 }], Ie.P6.book_append_sheet(e, s, "Reporte"), (0, Ie.NC)(e, "Reporte Diferencias [Toma #" + this.report.taking.id_taking + "]" + a + ".xlsx") }, makeRecount() { this.recount_confirm ? this.$emit("makeRecount", "all") : this.recount_confirm = !0 }, closeTaking() { this.close_confirm ? this.$emit("closeTaking", this.report.taking.id_taking) : this.close_confirm = !0 } } }; const Ke = (0, p.Z)(Fe, [["render", $e], ["__scopeId", "data-v-294e25fe"]]); var Je = Ke; const Ye = { class: "bg-light" }, Ze = { key: 0, class: "container-fluid mt-3" }, Ve = { class: "table table-hover table-bordered", id: "report" }, Qe = (0, n._)("thead", null, [(0, n._)("tr", { class: "bg-secondary text-white" }, [(0, n._)("th", { class: "text-center" }, "#"), (0, n._)("th", { class: "text-center text-nowrap" }, "Producto"), (0, n._)("th", { class: "text-center" }, "SKU"), (0, n._)("th", { class: "text-center" }, "Capacidad"), (0, n._)("th", { class: "text-center" }, "CxCaja"), (0, n._)("th", { class: "text-center" }, "Stock"), (0, n._)("th", { class: "text-center" }, "Toma"), (0, n._)("th", { class: "text-center" }, "Diff"), (0, n._)("th", { class: "text-center" }, "Status")])], -1), ts = ["onClick"], es = { class: "text-center" }, ss = { class: "text-end" }, as = { class: "text-end" }, ns = { class: "text-end" }, rs = { class: "text-end" }, ls = { class: "text-end" }, os = { key: 0, class: "text-center text-success" }, is = { key: 1, class: "text-center text-danger" }, cs = { key: 2, class: "text-center" }, ds = { key: 0, class: "text-info" }, _s = { key: 1, class: "text-danger" }, us = { key: 1 }; function ps(t, e, s, a, r, l) { const o = (0, n.up)("base-detail"); return (0, n.wg)(), (0, n.iD)("div", Ye, [r.show_view_report ? ((0, n.wg)(), (0, n.iD)("div", Ze, [(0, n._)("table", Ve, [Qe, (0, n._)("tbody", null, [((0, n.wg)(!0), (0, n.iD)(n.HY, null, (0, n.Ko)(s.table_takings, ((t, e) => ((0, n.wg)(), (0, n.iD)("tr", { key: t, onClick: e => l.showItemDetail(t) }, [(0, n._)("td", es, (0, k.zw)(e + 1), 1), (0, n._)("td", null, (0, k.zw)(t.product.name), 1), (0, n._)("td", null, (0, k.zw)(t.product.ean_13_code), 1), (0, n._)("td", ss, (0, k.zw)(t.product.capacity), 1), (0, n._)("td", as, (0, k.zw)(t.product.quantity_per_box), 1), (0, n._)("td", ns, (0, k.zw)(t.sap_stock), 1), (0, n._)("td", rs, (0, k.zw)(t.tk_quantity), 1), (0, n._)("td", ls, (0, k.zw)(t.sap_stock - t.tk_quantity), 1), t.sap_stock === t.tk_quantity ? ((0, n.wg)(), (0, n.iD)("td", os, "COMPLETO")) : (0, n.kq)("", !0), t.sap_stock < t.tk_quantity ? ((0, n.wg)(), (0, n.iD)("td", is, "SOBRANTE")) : (0, n.kq)("", !0), t.sap_stock > t.tk_quantity ? ((0, n.wg)(), (0, n.iD)("td", cs, [0 === t.tk_quantity ? ((0, n.wg)(), (0, n.iD)("span", ds, "SIN TOMA")) : ((0, n.wg)(), (0, n.iD)("span", _s, "FALTANTE"))])) : (0, n.kq)("", !0)], 8, ts)))), 128))])])])) : ((0, n.wg)(), (0, n.iD)("div", us, [(0, n.Wm)(o, { selected_item: r.selected_item, show_view_report: r.show_view_report, base_url: s.base_url, report: s.report, taking_is_open: s.taking_is_open, csrf_token: s.csrf_token, onShowReport: l.showReport, onMakeRecount: e[0] || (e[0] = t => l.makeRecount(t)) }, null, 8, ["selected_item", "show_view_report", "base_url", "report", "taking_is_open", "csrf_token", "onShowReport"])]))]) } var gs = s(7387), hs = s.n(gs), ks = s(9498); const bs = { key: 1, class: "container-fluid mt-3 border bg-white" }, ms = { class: "row bg bg-ligth bg-gradient h5" }, ws = { class: "col-1" }, fs = { class: "badge bg-dark" }, vs = { class: "col-10 text-center" }, ys = { class: "text-primary", id: "app-product-desc" }, xs = { class: "text-dark" }, qs = (0, n._)("br", null, null, -1), Ds = (0, n._)("hr", null, null, -1), Cs = { class: "col text-end" }, Rs = (0, n._)("i", { class: "fas fa-close" }, null, -1), Ts = [Rs], zs = { class: "row bg-ligth" }, Us = { class: "col-3" }, Es = ["src"], Ss = { class: "row" }, js = { class: "col" }, Ms = { class: "list-group" }, Hs = { class: "list-group-item" }, Os = (0, n._)("strong", null, "Cod Contable:", -1), Ls = { class: "badge bg-dark" }, As = { class: "list-group-item" }, Ps = (0, n._)("strong", null, "Cap:", -1), Xs = (0, n._)("span", { class: "text-seondary" }, " |  ", -1), Bs = (0, n._)("strong", null, "CxCaja:", -1), Ns = { class: "col" }, Gs = { class: "d-flex align-items-start" }, Ws = { class: "nav flex-column nav-pills me-3", id: "v-pills-tab", role: "tablist", "aria-orientation": "vertical" }, $s = (0, n.uE)('<button class="btn btn-white active btn-sm" data-bs-toggle="pill" data-bs-target="#v-pills-home"><i class="fas fa-clipboard-check"></i><br>Toma </button><button class="btn btn-white btn-sm" data-bs-toggle="pill" data-bs-target="#v-pills-profile"><i class="fas fa-warning"></i>  Novedades </button><button class="btn btn-white btn-sm" data-bs-toggle="pill" data-bs-target="#v-pills-messages"><i class="fas fa-warehouse"></i> Existencias </button>', 3), Is = { key: 0, class: "text-danger" }, Fs = (0, n._)("i", { class: "fas fa-check" }, null, -1), Ks = { key: 1 }, Js = (0, n._)("i", { class: "fas fa-share" }, null, -1), Ys = { class: "tab-content", id: "v-pills-tabContent", style: { width: "100%" } }, Zs = { class: "tab-pane fade show active", id: "v-pills-home", role: "tabpanel", "aria-labelledby": "v-pills-home-tab" }, Vs = { class: "border" }, Qs = { class: "row" }, ta = { class: "col" }, ea = { class: "row text-center" }, sa = { class: "col text-center" }, aa = (0, n._)("span", { class: "h4 text-secondary" }, "Stock", -1), na = { class: "h4 text-secondary" }, ra = { class: "col text-center" }, la = (0, n._)("span", { class: "h4 text-primary" }, "Toma", -1), oa = { class: "h4 text-primary" }, ia = { class: "h4" }, ca = { key: 0, class: "h4" }, da = { class: "row mt-2" }, _a = { class: "col" }, ua = { class: "table table-bordered table-hover" }, pa = (0, n._)("thead", null, [(0, n._)("tr", { class: "text-center bg-gray-gradient" }, [(0, n._)("th", null, "#"), (0, n._)("th", null, "Hora"), (0, n._)("th", null, "Grupo"), (0, n._)("th", null, "Manager"), (0, n._)("th", null, "Cajas"), (0, n._)("th", null, "Unds"), (0, n._)("th", null, "Total"), (0, n._)("th", { class: "text-center text-danger" }, [(0, n._)("i", { class: "fas fa-trash" })])])], -1), ga = { class: "text-center" }, ha = { class: "text-center" }, ka = { class: "text-end" }, ba = { class: "text-end" }, ma = { class: "text-end bg-gray" }, wa = ["onClick"], fa = { key: 0, class: "fas fa-minus" }, va = { key: 1, class: "fa-solid fa-check text-danger" }, ya = { class: "bg-success-gradient text-bold" }, xa = (0, n._)("td", { colspan: "4", class: "text-end" }, [(0, n._)("strong", null, "Sumas:")], -1), qa = { class: "text-end" }, Da = { class: "text-end" }, Ca = { class: "text-end" }, Ra = (0, n._)("td", { class: "text-center" }, "--", -1), Ta = { class: "tab-pane fade", id: "v-pills-profile", role: "tabpanel", "aria-labelledby": "v-pills-profile-tab" }, za = { class: "row mt-2" }, Ua = { class: "col" }, Ea = { class: "table table-bordered table-hover" }, Sa = (0, n._)("thead", null, [(0, n._)("tr", { class: "text-center bg-gray-gradient" }, [(0, n._)("th", null, "#"), (0, n._)("th", null, "Grupo"), (0, n._)("th", null, "Novedad"), (0, n._)("th", null, "Año"), (0, n._)("th", null, "Caducidad"), (0, n._)("th", null, "Unds")])], -1), ja = { class: "badge bg-info" }, Ma = { class: "text-end" }, Ha = { class: "text-end" }, Oa = { class: "text-end" }, La = { class: "tab-pane fade", id: "v-pills-messages", role: "tabpanel", "aria-labelledby": "v-pills-messages-tab" }, Aa = { class: "row" }, Pa = { class: "col" }, Xa = { class: "table table-bordered table-hover" }, Ba = (0, n._)("thead", null, [(0, n._)("tr", { class: "text-center bg-gray-gradient" }, [(0, n._)("th", null, "#"), (0, n._)("th", null, "Empresa"), (0, n._)("th", null, "Bodega"), (0, n._)("th", null, "Cajas"), (0, n._)("th", null, "Unds"), (0, n._)("th", null, "Total")])], -1), Na = { class: "badge bg-success" }, Ga = { class: "text-end" }, Wa = { class: "text-end" }, $a = { class: "text-end" }, Ia = { class: "bg-gray-gradient" }, Fa = (0, n._)("th", { colspan: "3" }, "Sumas", -1), Ka = { class: "text-end" }, Ja = { class: "text-end" }, Ya = { class: "text-end" }; function Za(t, e, s, a, r, l) { const o = (0, n.up)("loader"); return (0, n.wg)(), (0, n.iD)("div", null, [r.item_report ? (0, n.kq)("", !0) : ((0, n.wg)(), (0, n.j4)(o, { key: 0 })), r.item_report ? ((0, n.wg)(), (0, n.iD)("div", bs, [(0, n._)("div", ms, [(0, n._)("div", ws, [(0, n._)("span", fs, (0, k.zw)(s.selected_item.product.type_product), 1)]), (0, n._)("div", vs, [(0, n._)("span", ys, [(0, n.Uk)((0, k.zw)(s.selected_item.product.name) + "   ", 1), (0, n._)("span", xs, " Cajas X " + (0, k.zw)(s.selected_item.product.quantity_per_box) + " Unds ", 1), qs, (0, n._)("small", null, (0, k.zw)(s.selected_item.product.ean_13_code), 1)]), Ds]), (0, n._)("div", Cs, [(0, n._)("button", { class: "btn btn-outline-danger fs-5", onClick: e[0] || (e[0] = (...t) => l.showReport && l.showReport(...t)) }, Ts)])]), (0, n._)("div", zs, [(0, n._)("div", Us, [(0, n._)("img", { src: l.image_url, class: "img-thumbnail" }, null, 8, Es), (0, n._)("div", Ss, [(0, n._)("div", js, [(0, n._)("ul", Ms, [(0, n._)("li", { class: (0, k.C_)(["list-group-item text-center h5", l.status_taking.class]) }, [(0, n._)("i", { class: (0, k.C_)(l.status_taking.icon) }, null, 2), (0, n.Uk)("   "), (0, n._)("strong", null, (0, k.zw)(l.status_taking.text), 1)], 2), (0, n._)("li", Hs, [Os, (0, n.Uk)(" " + (0, k.zw)(s.selected_item.product.account_code) + "  |   ", 1), (0, n._)("span", Ls, " #: " + (0, k.zw)(s.selected_item.product.id_product), 1)]), (0, n._)("li", As, [Ps, (0, n.Uk)(" " + (0, k.zw)(s.selected_item.product.capacity) + " ", 1), Xs, Bs, (0, n.Uk)(" " + (0, k.zw)(s.selected_item.product.quantity_per_box), 1)])])])])]), (0, n._)("div", Ns, [(0, n._)("div", Gs, [(0, n._)("div", Ws, [$s, s.taking_is_open && "Completo" != l.status_taking.text ? ((0, n.wg)(), (0, n.iD)("button", { key: 0, class: "btn btn-warning mt-5 btn-sm", id: "recount-item", onClick: e[1] || (e[1] = (...t) => l.makeRecount && l.makeRecount(...t)) }, [r.confirm_recount ? ((0, n.wg)(), (0, n.iD)("span", Is, [Fs, (0, n.Uk)(" CONFIRMAR")])) : ((0, n.wg)(), (0, n.iD)("span", Ks, [Js, (0, n.Uk)(" RECONTEO ")]))])) : (0, n.kq)("", !0)]), (0, n._)("div", Ys, [(0, n._)("div", Zs, [(0, n._)("div", Vs, [(0, n._)("div", Qs, [(0, n._)("div", ta, [(0, n._)("div", ea, [(0, n._)("div", sa, [aa, (0, n.Uk)("   "), (0, n._)("span", na, (0, k.zw)(s.selected_item.sap_stock), 1)]), (0, n._)("div", ra, [la, (0, n.Uk)("   "), (0, n._)("span", oa, (0, k.zw)(l.total_quantity), 1)]), (0, n._)("div", { class: (0, k.C_)(["col text-center", l.status_taking.class]) }, [(0, n._)("i", { class: (0, k.C_)(["h4", l.status_taking.icon]) }, null, 2), (0, n.Uk)("   "), (0, n._)("span", ia, (0, k.zw)(l.status_taking.text), 1), (0, n.Uk)("   "), l.sale_boxes ? ((0, n.wg)(), (0, n.iD)("span", ca, (0, k.zw)(l.sale_boxes), 1)) : (0, n.kq)("", !0)], 2)])])])]), (0, n._)("div", da, [(0, n._)("div", _a, [(0, n._)("table", ua, [pa, (0, n._)("tbody", null, [((0, n.wg)(!0), (0, n.iD)(n.HY, null, (0, n.Ko)(r.item_report.takings, ((t, e) => ((0, n.wg)(), (0, n.iD)("tr", { key: t }, [(0, n._)("td", ga, (0, k.zw)(e + 1), 1), (0, n._)("td", null, (0, k.zw)(new Date(t.taking.created).toLocaleString("es-EC")), 1), (0, n._)("td", ha, (0, k.zw)(t.team.group_number), 1), (0, n._)("td", null, (0, k.zw)(t.user.first_name) + " " + (0, k.zw)(t.user.last_name), 1), (0, n._)("td", ka, (0, k.zw)(t.taking.taking_total_boxes), 1), (0, n._)("td", ba, (0, k.zw)(t.taking.taking_total_bottles), 1), (0, n._)("td", ma, (0, k.zw)(t.taking.quantity), 1), (0, n._)("td", { class: "text-center text-danger", onClick: e => l.delteItemDetail(t.taking.id_taking_detail) }, [r.confirm_delete_detail ? ((0, n.wg)(), (0, n.iD)("i", va, " Confirmar ")) : ((0, n.wg)(), (0, n.iD)("i", fa))], 8, wa)])))), 128)), (0, n._)("tr", ya, [xa, (0, n._)("td", qa, [(0, n._)("strong", null, (0, k.zw)(l.total_boxes), 1)]), (0, n._)("td", Da, [(0, n._)("strong", null, (0, k.zw)(l.total_bottles), 1)]), (0, n._)("td", Ca, [(0, n._)("strong", null, (0, k.zw)(l.total_quantity), 1)]), Ra])])])])])]), (0, n._)("div", Ta, [(0, n._)("div", za, [(0, n._)("div", Ua, [(0, n._)("table", Ea, [Sa, (0, n._)("tbody", null, [((0, n.wg)(!0), (0, n.iD)(n.HY, null, (0, n.Ko)(r.item_report.takings, ((t, e) => ((0, n.wg)(), (0, n.iD)("tr", { key: t }, [(0, n._)("td", null, (0, k.zw)(e + 1), 1), (0, n._)("td", null, [(0, n._)("span", ja, "G#" + (0, k.zw)(t.team.group_number), 1), (0, n.Uk)(" " + (0, k.zw)(t.user.first_name) + " " + (0, k.zw)(t.user.last_name), 1)]), (0, n._)("td", null, (0, k.zw)(t.taking.notes ? t.taking.notes : "--"), 1), (0, n._)("td", Ma, (0, k.zw)(t.taking.year ? t.taking.year : "--"), 1), (0, n._)("td", Ha, (0, k.zw)(t.taking.date_expiry ? new Date(t.taking.date_expiry).toLocaleDateString("es-EC") : "--"), 1), (0, n._)("td", Oa, (0, k.zw)(t.taking.quantity), 1)])))), 128))])])])])]), (0, n._)("div", La, [(0, n._)("div", Aa, [(0, n._)("div", Pa, [(0, n._)("table", Xa, [Ba, (0, n._)("tbody", null, [((0, n.wg)(!0), (0, n.iD)(n.HY, null, (0, n.Ko)(r.item_report.migrations, ((t, e) => ((0, n.wg)(), (0, n.iD)("tr", { key: t }, [(0, n._)("td", null, (0, k.zw)(e + 1), 1), (0, n._)("td", null, (0, k.zw)(t.company_name), 1), (0, n._)("td", null, [(0, n._)("span", Na, (0, k.zw)(t.id_warenhouse_sap_code), 1), (0, n.Uk)(" " + (0, k.zw)(t.warenhouse_name), 1)]), (0, n._)("td", Ga, (0, k.zw)(Math.floor(t.on_hand / s.selected_item.product.quantity_per_box)), 1), (0, n._)("td", Wa, (0, k.zw)(t.on_hand - Math.floor(t.on_hand / s.selected_item.product.quantity_per_box) * s.selected_item.product.quantity_per_box), 1), (0, n._)("td", $a, (0, k.zw)(t.on_hand), 1)])))), 128)), (0, n._)("tr", Ia, [Fa, (0, n._)("td", Ka, [(0, n._)("strong", null, (0, k.zw)(Math.floor(l.total_stocks / s.selected_item.product.quantity_per_box)), 1)]), (0, n._)("td", Ja, [(0, n._)("strong", null, (0, k.zw)(l.total_stocks - Math.floor(l.total_stocks / s.selected_item.product.quantity_per_box) * s.selected_item.product.quantity_per_box), 1)]), (0, n._)("td", Ya, [(0, n._)("strong", null, (0, k.zw)(l.total_stocks), 1)])])])])])])])])])])])])) : (0, n.kq)("", !0)]) } var Va = { components: { Loader: h }, name: "BaseDetail", componets: { Loader: h }, emits: ["showReport", "makeRecount"], data() { return { item_report: null, stock_report: null, recount_url: null, confirm_recount: !1, confirm_delete_detail: !1 } }, props: { selected_item: { type: Object, required: !0 }, show_view_report: { type: Boolean, required: !0 }, base_url: { type: String, required: !0 }, report: { type: Object, required: !0 }, taking_is_open: { type: Boolean, required: !0 }, csrf_token: { type: String, required: !0 } }, methods: { showReport() { this.$emit("showReport") }, sendGetRequest(t, e) { const s = new XMLHttpRequest; s.open("GET", this.base_url + t), s.setRequestHeader("Content-Type", "application/json"), s.setRequestHeader("X-Requested-With", "XMLHttpRequest"), s.onload = () => { if (200 === s.status) return e(JSON.parse(s.responseText)); alert("Error en peticion GET") }, s.onerror = () => { alert("Error en peticion GET evento on onerror") }, s.send() }, loadTakingData(t) { this.item_report = t, this.recount_url = "/recounts/make/taking/{id_taking}/product/{account_code}", this.recount_url = this.recount_url.replace("{id_taking}", this.report.taking.id_taking), this.recount_url = this.recount_url.replace("{account_code}", this.selected_item.product.account_code) }, makeRecount() { if (!this.confirm_recount) return this.confirm_recount = !0, !1; this.$emit("makeRecount", this.selected_item.product.account_code), this.showReport(), this.confirm_recount = !1 }, delteItemDetail(t) { if (!this.confirm_delete_detail) return void (this.confirm_delete_detail = !0); let e = `/api/takings-detail/delete/${t}/`, s = new XMLHttpRequest; s.open("DELETE", this.base_url + e), s.setRequestHeader("Content-Type", "application/json"), s.setRequestHeader("X-Requested-With", "XMLHttpRequest"), s.setRequestHeader("X-CSRFToken", this.csrf_token), s.onload = () => { 204 === s.status ? this.item_report.takings = this.item_report.takings.filter((e => e.taking.id_taking_detail !== t)) : alert("Error en peticion DELETE") }, s.onerror = () => { alert("Error en peticion DELETE evento on onerror") }, s.send() } }, mounted() { this.sendGetRequest("/api/common/taking-migration/taking/{pk_taking}/product/{pk_product}/".replace("{pk_product}", this.selected_item.product.account_code).replace("{pk_taking}", this.report.taking.id_taking), this.loadTakingData) }, unmounted() { this.item_report = null }, computed: { image_url() { return this.selected_item.product.image_front ? this.base_url + this.selected_item.product.image_front : this.base_url + "/static/img/generic_product.png" }, total_boxes() { return this.item_report.takings.reduce(((t, e) => t + e.taking.taking_total_boxes), 0) }, total_bottles() { return this.item_report.takings.reduce(((t, e) => t + e.taking.taking_total_bottles), 0) }, total_quantity() { return this.item_report.takings.reduce(((t, e) => t + e.taking.quantity), 0) }, status_taking() { return this.selected_item.sap_stock === this.total_quantity ? { text: "Completo", class: "text-success", icon: "fas fa-check" } : this.selected_item.sap_stock > this.total_quantity ? { text: "Faltante", class: "text-warning", icon: "fas fa-exclamation-triangle" } : this.selected_item.sap_stock < this.total_quantity ? { text: "Sobrante", class: "text-danger", icon: "fas fa-exclamation-triangle" } : void 0 }, sale_boxes() { return Math.abs(this.selected_item.sap_stock - this.total_quantity) }, total_stocks() { return this.item_report.migrations.reduce(((t, e) => t + e.on_hand), 0) }, boxesConverter(t) { if ("number" != typeof t) return { boxes: 0, bottles: 0 }; let e = Math.floor(t / this.selected_item.product.quantity_per_box), s = t % this.selected_item.product.quantity_per_box; return { boxes: e, bottles: s } } } }; const Qa = (0, p.Z)(Va, [["render", Za]]); var tn = Qa; window.$ = hs(), window.jQuery = hs(); var en = { name: "TakingReport", emits: ["makeRecount"], props: { table_takings: { type: Object, required: !0 }, base_url: { type: String, required: !0 }, show_all_takings: { type: Boolean, required: !0 }, report: { type: Object, required: !0 }, taking_is_open: { type: Boolean, required: !0 }, csrf_token: { type: String, required: !0 } }, data() { return { selected_item: null, show_view_report: !0, datatable: null } }, methods: { showItemDetail(t) { this.show_view_report = !1, this.selected_item = t }, showReport() { this.show_view_report = !0, this.$nextTick((() => { this.initDataTable() })) }, makeRecount(t) { this.$emit("makeRecount", t) }, initDataTable() { null !== this.datatable && (this.datatable.destroy(), this.datatable = null), this.dataTable = new ks.Z("#report", { pageLength: 25, lengthMenu: [10, 25, 50, 75, 100, 200, 500, 1e3], language: { url: "//cdn.datatables.net/plug-ins/1.10.25/i18n/Spanish.json" } }) } }, components: { BaseDetail: tn }, watch: { show_view_report() { this.show_view_report && this.initDataTable() } }, mounted() { this.$nextTick((() => { this.initDataTable() })) } }; const sn = (0, p.Z)(en, [["render", ps]]); var an = sn; const nn = (0, n.uE)('<div class="container-fluid mt-3"><div class="row"><div class="col"><table class="table table-bordered table-hover" id="group-info"><thead><tr class="bg-primary text-white"><th class="text-center">#</th><th class="text-center"><i class="fas fa-user"></i></th><th class="text-center">Auxiliar</th><th class="text-center"><i class="fas fa-refresh"></i></th><th class="text-center"><i class="fas fa-clock"></i></th></tr></thead><tbody><tr><td class="text-center">1</td><td>Eduardo Villota</td><td>Afredo Caamanero</td><td class="text-center"><label for="" class="badge bg-success">21</label></td><td>12 de Febrero a las 09:00</td></tr><tr><td class="text-center">2</td><td>Carlos Villota</td><td>Carlos Caamanero</td><td class="text-center"><label for="" class="badge bg-success">21</label></td><td>12 de Febrero a las 09:00</td></tr><tr><td class="text-center">3</td><td>Carlos Villota</td><td>Carlos Caamanero</td><td class="text-center"><label for="" class="badge bg-success">21</label></td><td>12 de Febrero a las 09:00</td></tr></tbody></table></div><div class="col"><table class="table table-bordered table-hover"><thead><tr class="bg-secondary"><th>#</th><th>Producto</th><th>Toma</th></tr></thead><tbody><tr><td>1</td><td>Porducto en mejor de todos</td><td>423</td></tr></tbody></table></div></div></div>', 1), rn = [nn]; function ln(t, e, s, a, r, l) { return (0, n.wg)(), (0, n.iD)("div", null, rn) } var on = { name: "GroupsInfo", data: function () { return { data: "Genial" } }, methods: { updateData: function () { this.data = [] } }, mounted: function () { new ks.Z("#group-info", { pageLength: -1, lengthMenu: [[20, 50, 100, -1], ["20", "50", "100", "Todos"]], searching: !1, paging: !1 }) } }; const cn = (0, p.Z)(on, [["render", ln]]); var dn = cn; const _n = "", un = url_data, pn = csrftoken, gn = user_data; var hn = { name: "App", components: { NavBar: _e, InfoBar: Je, TakingReport: an, GroupsInfo: dn, Loader: h }, data() { return { base_url: _n, csrf_token: pn, url_data: un, userdata: gn, report: null, warenhouses: null, table_takings: null, show_all_takings: !0, filtered: !0, taking_is_open: !1 } }, methods: { updateData: function () { const t = new XMLHttpRequest; t.open("GET", this.base_url + this.url_data), t.setRequestHeader("Content-Type", "application/json"), t.setRequestHeader("X-Requested-With", "XMLHttpRequest"), t.onload = () => { if (200 === t.status) { this.report = JSON.parse(t.responseText), this.taking_is_open = this.report.taking.is_active; let e = JSON.parse(this.report.taking.warenhouses); this.warenhouses = e.map((t => ({ name: t, selected: !0 }))), this.report.all_warenhouses.sort(((t, e) => t.name > e.name ? 1 : t.name < e.name ? -1 : 0)), this.table_takings = JSON.parse(t.responseText).report, this.show_all_takings = !1 } }, t.onerror = () => { alert("Error al cargar los datos") }, t.send() }, updateWarenhouses: function () { const t = this.warenhouses.filter((t => t.selected)).map((t => t.name)).concat(this.report.all_warenhouses.filter((t => t.selected)).map((t => t.name))); if (0 === t.length) return; const e = this.report.taking; e.warenhouses = JSON.stringify(t); const s = new XMLHttpRequest; s.open("PUT", this.base_url + "/api/takings/update-taking/" + e.id_taking + "/"), s.setRequestHeader("Content-Type", "application/json"), s.setRequestHeader("X-Requested-With", "XMLHttpRequest"), s.setRequestHeader("X-CSRFToken", this.csrf_token), s.onload = () => { 200 === s.status && location.reload() }, s.onerror = () => { alert("Error al cargar los datos") }, s.send(JSON.stringify(e)) }, showAllTakings() { this.show_all_takings = !this.show_all_takings }, filterReport() { this.filtered = !1, setTimeout((() => { this.table_takings = []; const t = this.report.report.map((t => t)); if (this.show_all_takings) return this.table_takings = t, void (this.filtered = !0); this.table_takings = t.filter((t => !1 === t.is_complete)), this.filtered = !0 }), 100) }, makeRecount(t) { let e = this.report.taking.id_taking, s = `/api/common/recount/${e}/${t}/`; const a = new XMLHttpRequest; a.open("GET", this.base_url + s), a.setRequestHeader("Content-Type", "application/json"), a.setRequestHeader("X-Requested-With", "XMLHttpRequest"), a.onload = () => { if (200 === a.status) { let e = JSON.parse(a.responseText); if ("ok" != e.status) return void alert(`Error al ejecutar accion ${e.status}`); if ("all" === t) return void location.reload(); this.report.report.forEach((e => { e.product.account_code === t && (e.tk_botles = 0, e.tk_boxes = 0, e.tk_quantity = 0) })) } }, a.onerror = () => { alert("Error al actualizar el estado de la toma") }, a.send() }, closeTaking(t) { let e = this.report.taking; e.is_active = !1; const s = new XMLHttpRequest; s.open("PUT", this.base_url + "/api/takings/update-taking/" + t + "/"), s.setRequestHeader("Content-Type", "application/json"), s.setRequestHeader("X-Requested-With", "XMLHttpRequest"), s.setRequestHeader("X-CSRFToken", this.csrf_token), s.onload = () => { 200 === s.status && location.reload() }, s.onerror = () => { alert("Error al completar la petición, toma no cerrada") }, s.send(JSON.stringify(e)) } }, mounted() { this.updateData() }, watch: { show_all_takings: function () { this.filterReport() } } }; const kn = (0, p.Z)(hn, [["render", r]]); var bn = kn; (0, a.ri)(bn).mount("#app") } }, e = {}; function s(a) { var n = e[a]; if (void 0 !== n) return n.exports; var r = e[a] = { exports: {} }; return t[a].call(r.exports, r, r.exports, s), r.exports } s.m = t, function () { var t = []; s.O = function (e, a, n, r) { if (!a) { var l = 1 / 0; for (d = 0; d < t.length; d++) { a = t[d][0], n = t[d][1], r = t[d][2]; for (var o = !0, i = 0; i < a.length; i++)(!1 & r || l >= r) && Object.keys(s.O).every((function (t) { return s.O[t](a[i]) })) ? a.splice(i--, 1) : (o = !1, r < l && (l = r)); if (o) { t.splice(d--, 1); var c = n(); void 0 !== c && (e = c) } } return e } r = r || 0; for (var d = t.length; d > 0 && t[d - 1][2] > r; d--)t[d] = t[d - 1]; t[d] = [a, n, r] } }(), function () { s.n = function (t) { var e = t && t.__esModule ? function () { return t["default"] } : function () { return t }; return s.d(e, { a: e }), e } }(), function () { s.d = function (t, e) { for (var a in e) s.o(e, a) && !s.o(t, a) && Object.defineProperty(t, a, { enumerable: !0, get: e[a] }) } }(), function () { s.g = function () { if ("object" === typeof globalThis) return globalThis; try { return this || new Function("return this")() } catch (t) { if ("object" === typeof window) return window } }() }(), function () { s.o = function (t, e) { return Object.prototype.hasOwnProperty.call(t, e) } }(), function () { s.r = function (t) { "undefined" !== typeof Symbol && Symbol.toStringTag && Object.defineProperty(t, Symbol.toStringTag, { value: "Module" }), Object.defineProperty(t, "__esModule", { value: !0 }) } }(), function () { var t = { 143: 0 }; s.O.j = function (e) { return 0 === t[e] }; var e = function (e, a) { var n, r, l = a[0], o = a[1], i = a[2], c = 0; if (l.some((function (e) { return 0 !== t[e] }))) { for (n in o) s.o(o, n) && (s.m[n] = o[n]); if (i) var d = i(s) } for (e && e(a); c < l.length; c++)r = l[c], s.o(t, r) && t[r] && t[r][0](), t[r] = 0; return s.O(d) }, a = self["webpackChunktaking_manager"] = self["webpackChunktaking_manager"] || []; a.forEach(e.bind(null, 0)), a.push = e.bind(null, a.push.bind(a)) }(); var a = s.O(void 0, [998], (function () { return s(2137) })); a = s.O(a) })();
//# sourceMappingURL=app.d26df06b.js.map